<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A system for querying, retrieving and analyzing protocol- and results-related information on clinical trials from four public registers, the European Union Clinical Trials Register (EUCTR, &lt;https://www.clinicaltrialsregister.eu/&gt;), ClinicalTrials.gov (CTGOV, using the classic interface at &lt;https://classic.clinicaltrials.gov/&gt;, and CTGOV2, using the current interface at &lt;https://www.clinicaltrials.gov/&gt;), the ISRCTN (&lt;http://www.isrctn.com/&gt;) and the European Union Clinical Trials Information System (CTIS, &lt;https://euclinicaltrials.eu/&gt;). Trial information is downloaded, converted and stored in a database (PostgreSQL, SQLite, DuckDB or MongoDB; via package nodbi). Documents in registers associated with trials can also be downloaded. Other functions identify deduplicated records, easily find and extract variables (fields) of interest even from complex nested data as used by the registers, merge variables and update queries. The package can be used for meta-analysis and trend-analysis of the design and conduct as well as of the results of clinical trials.">
<title>Retrieve and Analyze Clinical Trials in Public Registers • ctrdata</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Retrieve and Analyze Clinical Trials in Public Registers">
<meta property="og:description" content="A system for querying, retrieving and analyzing protocol- and results-related information on clinical trials from four public registers, the European Union Clinical Trials Register (EUCTR, &lt;https://www.clinicaltrialsregister.eu/&gt;), ClinicalTrials.gov (CTGOV, using the classic interface at &lt;https://classic.clinicaltrials.gov/&gt;, and CTGOV2, using the current interface at &lt;https://www.clinicaltrials.gov/&gt;), the ISRCTN (&lt;http://www.isrctn.com/&gt;) and the European Union Clinical Trials Information System (CTIS, &lt;https://euclinicaltrials.eu/&gt;). Trial information is downloaded, converted and stored in a database (PostgreSQL, SQLite, DuckDB or MongoDB; via package nodbi). Documents in registers associated with trials can also be downloaded. Other functions identify deduplicated records, easily find and extract variables (fields) of interest even from complex nested data as used by the registers, merge variables and update queries. The package can be used for meta-analysis and trend-analysis of the design and conduct as well as of the results of clinical trials.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@rfhb">
<meta name="twitter:site" content="@rfhb">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ctrdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.17.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/ctrdata_install.html">Install R package ctrdata</a>
    <a class="dropdown-item" href="articles/ctrdata_retrieve.html">Retrieve clinical trial information</a>
    <a class="dropdown-item" href="articles/ctrdata_summarise.html">Summarise and analyse clinical trial information</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rfhb/ctrdata/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p><a href="#main-features">Main features</a> • <a href="#installation">Installation</a> • <a href="#overview-of-functions-in-ctrdata">Overview</a> • <a href="#databases-for-use-with-ctrdata">Databases</a> • <a href="#data-model-of-ctrdata">Data model</a> • <a href="#example-workflow">Example workflow</a> • <a href="#workflow-cross-trial-example">Analysis across trials</a> • <a href="#tests">Tests</a> • <a href="#acknowledgements">Acknowledgements</a> • <a href="#future-features">Future</a></p>
<div class="section level1">
<div class="page-header"><h1 id="ctrdata-for-aggregating-and-analysing-clinical-trials">ctrdata for aggregating and analysing clinical trials<a class="anchor" aria-label="anchor" href="#ctrdata-for-aggregating-and-analysing-clinical-trials"></a>
</h1></div>
<p>The package <code>ctrdata</code> provides functions for retrieving (downloading) information on clinical trials from public registers, and for aggregating and analysing this information; it can be used for the</p>
<ul>
<li>EU Clinical Trials Register (“EUCTR”, <a href="https://www.clinicaltrialsregister.eu/" class="external-link uri">https://www.clinicaltrialsregister.eu/</a>)</li>
<li>EU Clinical Trials Information System (“CTIS”, <a href="https://euclinicaltrials.eu/" class="external-link uri">https://euclinicaltrials.eu/</a>, see <a href="#workflow-ctis-example">example</a>)</li>
<li>ClinicalTrials.gov (“CTGOV” classic and the 2023 “CTGOV2”, see <a href="#workflow-ctgov-example">example</a>)</li>
<li>ISRCTN Registry (<a href="https://www.isrctn.com/" class="external-link uri">https://www.isrctn.com/</a>)</li>
</ul>
<p>The motivation is to investigate and understand trends in design and conduct of trials, their availability for patients and to facilitate using their detailed results for research and meta-analyses. <code>ctrdata</code> is a package for the <a href="https://www.r-project.org/" class="external-link">R</a> system, but other systems and tools can be used with the databases created with the package. This README was reviewed on 2024-05-12 for version 1.17.2.9000 (major improvements: removed external dependencies; refactored <a href="https://rfhb.github.io/ctrdata/reference/dbGetFieldsIntoDf.html"><code>dbGetFieldsIntoDf()</code></a>; 🔔 retrieve historic CTGOV2 versions).</p>
<div class="section level2">
<h2 id="main-features">Main features<a class="anchor" aria-label="anchor" href="#main-features"></a>
</h2>
<ul>
<li>Protocol- and results-related trial information is easily downloaded: Users define a query in a register’s web interface, then copy the URL and enter it into <code>ctrdata</code> which retrieves in one go all trials found. A <a href="#id_2-script-to-automatically-copy-users-query-from-web-browser">script</a> can automate copying the query URL from all registers. Personal annotations can be made when downloading trials. Also, <a href="#documents-example">trial documents</a> and <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html#analysing-sample-size-using-historic-versions-of-trial-records">historic versions</a> available in registers on trials can be downloaded.</li>
<li>Downloaded trial information is transformed and stored in a collection of a document-centric database, for fast and offline access. Information from different registers can be accumulated in a single collection. Uses <code>DuckDB</code>, <code>PostgreSQL</code>, <code>RSQLite</code> or <code>MongoDB</code>, via R package <code>nodbi</code>: see section <a href="#databases-that-can-be-used-with-ctrdata">Databases</a> below. Easily re-run any previous query in a collection to retrieve and update trial records.</li>
<li>For analyses, convenience functions in <code>ctrdata</code> allow find synonyms of an active substance, to identify unique (de-duplicated) trial records across all registers, to merge and recode fields as well as to easily access deeply-nested fields. Analysis can be done with <code>R</code> (see <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">vignette</a>) or other systems, using the <code>JSON</code>-<a href="#mongodb">structured information in the database</a>.</li>
</ul>
<p>Remember to respect the registers’ terms and conditions (see <code>ctrOpenSearchPagesInBrowser(copyright = TRUE)</code>). Please cite this package in any publication as follows: “Ralf Herold (2024). <em>ctrdata: Retrieve and Analyze Clinical Trials in Public Registers.</em> R package version 1.17.2, <a href="https://cran.r-project.org/package=ctrdata" class="external-link uri">https://cran.r-project.org/package=ctrdata</a>”.</p>
<!--
&#10;```r
citation("ctrdata")
```
-->
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Package <code>ctrdata</code> has been used for unpublished work and for:</p>
<ul>
<li>Lasch et al. (2022) The Impact of COVID‐19 on the Initiation of Clinical Trials in Europe and the United States. Clinical Pharmacology &amp; Therapeutics <a href="https://doi.org/10.1002/cpt.2534" class="external-link uri">https://doi.org/10.1002/cpt.2534</a>
</li>
<li>Sood et al. Managing the Evidence Infodemic: Automation Approaches Used for Developing NICE COVID-19 Living Guidelines. medRxiv <a href="https://doi.org/10.1101/2022.06.13.22276242" class="external-link uri">https://doi.org/10.1101/2022.06.13.22276242</a> 🔔</li>
<li>Blogging on <a href="https://paediatricdata.eu/innovation-coming-to-paediatric-research/" class="external-link">Innovation coming to paediatric research</a>
</li>
<li>Cancer Research UK (2017) <a href="https://www.cancerresearchuk.org/about-us/we-develop-policy/policy-publications-and-research-tenders#Policy_publications4" class="external-link">The impact of collaboration: The value of UK medical research to EU science and health</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="id_1-install-package-ctrdata-in-r">1. Install package <code>ctrdata</code> in R<a class="anchor" aria-label="anchor" href="#id_1-install-package-ctrdata-in-r"></a>
</h3>
<p>Package <code>ctrdata</code> is <a href="https://cran.r-project.org/package=ctrdata" class="external-link">on CRAN</a> and <a href="https://github.com/rfhb/ctrdata" class="external-link">on GitHub</a>. Within <a href="https://www.r-project.org/" class="external-link">R</a>, use the following commands to install package <code>ctrdata</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install CRAN version:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ctrdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternatively, install development version:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rfhb/ctrdata"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These commands also install the package’s dependencies (<code>jsonlite</code>, <code>httr</code>, <code>curl</code>, <code>clipr</code>, <code>xml2</code>, <code>nodbi</code>, <code>stringi</code>, <code>tibble</code>, <code>lubridate</code>, <code>jqr</code>, <code>dplyr</code>, <code>zip</code> and <code>V8</code>).</p>
</div>
<div class="section level3">
<h3 id="id_2-script-to-automatically-copy-users-query-from-web-browser">2. Script to automatically copy user’s query from web browser<a class="anchor" aria-label="anchor" href="#id_2-script-to-automatically-copy-users-query-from-web-browser"></a>
</h3>
<p>This is optional; it works with all registers supported by <code>ctrdata</code> but is recommended for CTIS because the URL in the web browser does not reflect the parameters the user specified for querying this register.</p>
<p>In the web browser, install the <a href="https://www.tampermonkey.net/" class="external-link">Tampermonkey browser extension</a>, click on “New user script” and then on “Tools”, then enter into “Import from URL” this URL: <a href="https://raw.githubusercontent.com/rfhb/ctrdata/master/tools/ctrdataURLcopier.js" class="external-link"><code>https://raw.githubusercontent.com/rfhb/ctrdata/master/tools/ctrdataURLcopier.js</code></a> and last click on “Install”.</p>
<p>The browser extension can be disabled and enabled by the user. When enabled, the URLs to all user’s queries in the registers are automatically copied to the clipboard and can be pasted into the <code>queryterm = ...</code> parameter of function <a href="https://rfhb.github.io/ctrdata/reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a></p>
</div>
</div>
<div class="section level2">
<h2 id="overview-of-functions-in-ctrdata">Overview of functions in <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#overview-of-functions-in-ctrdata"></a>
</h2>
<p>The functions are listed in the approximate order of use in a user’s workflow (in bold, main functions). See also the <a href="https://rfhb.github.io/ctrdata/reference/index.html">package documentation overview</a>.</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Function name</th>
<th>Function purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser()</a></code></td>
<td>Open search pages of registers or execute search in web browser</td>
</tr>
<tr class="even">
<td><code><a href="reference/ctrFindActiveSubstanceSynonyms.html">ctrFindActiveSubstanceSynonyms()</a></code></td>
<td>Find synonyms and alternative names for an active substance</td>
</tr>
<tr class="odd">
<td><code><a href="reference/ctrGetQueryUrl.html">ctrGetQueryUrl()</a></code></td>
<td>Import from clipboard the URL of a search in one of the registers</td>
</tr>
<tr class="even">
<td><code><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a></code></td>
<td><strong>Retrieve (download) or update, and annotate, information on trials from a register and store in a collection in a database</strong></td>
</tr>
<tr class="odd">
<td><code><a href="reference/dbQueryHistory.html">dbQueryHistory()</a></code></td>
<td>Show the history of queries that were downloaded into the collection</td>
</tr>
<tr class="even">
<td><code><a href="reference/dbFindIdsUniqueTrials.html">dbFindIdsUniqueTrials()</a></code></td>
<td><strong>Get the identifiers of de-duplicated trials in the collection</strong></td>
</tr>
<tr class="odd">
<td><code><a href="reference/dbFindFields.html">dbFindFields()</a></code></td>
<td>Find names of variables (fields) in the collection</td>
</tr>
<tr class="even">
<td><code><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a></code></td>
<td><strong>Create a data frame (or tibble) from trial records in the database with the specified fields</strong></td>
</tr>
<tr class="odd">
<td><code><a href="reference/dfTrials2Long.html">dfTrials2Long()</a></code></td>
<td>Transform the data.frame from <code><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a></code> into a long name-value data.frame, including deeply nested fields</td>
</tr>
<tr class="even">
<td><code><a href="reference/dfName2Value.html">dfName2Value()</a></code></td>
<td>From a long name-value data.frame, extract values for variables (fields) of interest (e.g., endpoints)</td>
</tr>
<tr class="odd">
<td><code><a href="reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel()</a></code></td>
<td>Merge variables into a new variable, optionally map values to a new set of levels</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="databases-for-use-with-ctrdata">Databases for use with <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#databases-for-use-with-ctrdata"></a>
</h2>
<p>Package <code>ctrdata</code> retrieves trial information and stores it in a database collection, which has to be given as a connection object to parameter <code>con</code> for several <code>ctrdata</code> functions; this connection object is created in slightly different ways for the four supported database backends that can be used with <code>ctrdata</code> as shown in the table. For a speed comparison, see the <a href="https://github.com/ropensci/nodbi#benchmark" class="external-link">nodbi documentation</a>.</p>
<p>Besides ctrdata functions below, any such a connection object can equally be used with functions of other packages, such as <code>nodbi</code> (last row in table) or, in case of MongoDB as database backend, <code>mongolite</code> (see vignettes).</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Purpose</th>
<th>Function call</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Create <strong>SQLite</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_sqlite(dbname = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr class="even">
<td>Create <strong>MongoDB</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_mongo(db = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr class="odd">
<td>Create <strong>PostgreSQL</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_postgres(dbname = "name_of_my_database"); dbc[["collection"]] &lt;- "name_of_my_collection"</code></td>
</tr>
<tr class="even">
<td>Create <strong>DuckDB</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_duckdb(dbdir = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr class="odd">
<td>Use connection with <code>ctrdata</code> functions</td>
<td><code>ctrdata::{ctrLoadQueryIntoDb, dbQueryHistory, dbFindIdsUniqueTrials, dbFindFields, dbGetFieldsIntoDf}(con = dbc, ...)</code></td>
</tr>
<tr class="even">
<td>Use connection with <code>nodbi</code> functions</td>
<td>e.g., <code>nodbi::docdb_query(src = dbc, key = dbc$collection, ...)</code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="data-model-of-ctrdata">Data model of <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#data-model-of-ctrdata"></a>
</h2>
<p>Package <code>ctrdata</code> uses the data models that are implicit in data retrieved from the different registers. No mapping is provided for any register’s data model to a putative target data model. The reasons include that registers’ data models are notably evolving over time and that there are only few data fields with similar values and meaning between the registers.</p>
<p>Thus, the handling of data from different models of registers is to be done at the time of analysis. This approach allows a high level of flexibility, transparency and reproducibility. See examples in the help text for function <a href="https://rfhb.github.io/ctrdata/reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel()</a> and section <a href="#workflow-cross-trial-example">Analysis across trials</a> below for how to align related fields from different registers for a joint analysis.</p>
<p>In any of the <code>NoSQL</code> <a href="https://rfhb.github.io/ctrdata/index.html#databases-for-use-with-ctrdata">databases</a>, one clinical trial is one document, corresponding to one row in a <code>SQLite</code>, <code>PostgreSQL</code> or <code>DuckDB</code> table, and to one document in a <code>MongoDB</code> collection. The <code>NoSQL</code> backends allow documents to have different structures, which is used here to accommodate the different data models of registers. Package <code>ctrdata</code> stores in every such document:</p>
<ul>
<li>field <code>_id</code> with the trial identification as provided by the register from which it was retrieved</li>
<li>field <code>ctrname</code> with the name of the register (<code>EUCTR</code>, <code>CTGOV</code>, <code>CTGOV2</code>, <code>ISRCTN</code>, <code>CTIS</code>) from which that trial was retrieved</li>
<li>field <code>record_last_import</code> with the date and time when that document was last updated using <code><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a></code>
</li>
<li>only for <code>CTGOV2</code>: object <code>history</code> with a historic version of the trial and with <code>history_version</code>, which contains the fields <code>version_number</code> (starting from 1) and <code>version_date</code>
</li>
<li>all original fields as provided by the register for that trial (see examples <a href="https://rfhb.github.io/ctrdata/index.html#trial-records-json-in-databases">below</a>)</li>
</ul>
<p>For visualising the data structure for a trial, see this <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html#analysing-nested-fields-such-as-trial-results">vignette section</a>.</p>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ul>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_install.html">Install R package ctrdata</a></li>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_retrieve.html">Retrieve clinical trial information</a></li>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">Summarise and analyse clinical trial information</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-workflow">Example workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h2>
<p>The aim is to download protocol-related trial information and tabulate the trials’ status of conduct.</p>
<ul>
<li>Attach package <code>ctrdata</code>:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=ctrdata" class="external-link">ctrdata</a></span><span class="op">)</span></span></code></pre></div>
<ul>
<li>See help to get started with <code>ctrdata</code>:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"ctrdata"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Information on trial registers that can be used with <code>ctrdata</code>:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"ctrdata-registers"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Open registers’ advanced search pages in browser:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Please review and respect register copyrights:</span></span>
<span><span class="fu"><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser</a></span><span class="op">(</span>copyright <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Adjust search parameters and execute search in browser</p></li>
<li><p>When trials of interest are listed in browser, <em>copy the address from the browser’s address bar to the clipboard</em></p></li>
<li><p>Search used in this example: <a href="https://www.clinicaltrialsregister.eu/ctr-search/search?query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed" class="external-link uri">https://www.clinicaltrialsregister.eu/ctr-search/search?query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed</a></p></li>
<li><p>Get address from clipboard:</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ctrGetQueryUrl.html">ctrGetQueryUrl</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># * Using clipboard content as register query URL: https://www.clinicaltrialsregister.eu/ctr-search/search?query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed</span></span>
<span><span class="co"># * Found search query from EUCTR: query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed</span></span>
<span></span>
<span><span class="va">q</span></span>
<span><span class="co">#                                                   query-term  query-register</span></span>
<span><span class="co"># 1 query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed           EUCTR</span></span></code></pre></div>
<p>🔔 Queries in the trial registers can automatically copied to the clipboard (including for “CTIS”, where the URL does not show the query) using our solution <a href="#id_3-script-to-automatically-copy-users-query-from-web-browser">here</a>.</p>
<ul>
<li>Retrieve protocol-related information, transform and save to database:</li>
</ul>
<p>The database collection is specified first, using <code>nodbi</code> (see above for how to specify <code>PostgreSQL</code>, <code>RSQlite</code>, <code>DuckDB</code> or <code>MongoDB</code> as backend, see section <a href="#databases-that-can-be-used-with-ctrdata">Databases</a>); then, trial information is retrieved and loaded into the collection:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Connect to (or create) an SQLite database</span></span>
<span><span class="co"># stored in a file on the local system:</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">nodbi</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/nodbi/reference/src_sqlite.html" class="external-link">src_sqlite</a></span><span class="op">(</span></span>
<span>  dbname <span class="op">=</span> <span class="st">"some_database_name.sqlite_file"</span>,</span>
<span>  collection <span class="op">=</span> <span class="st">"some_collection_name"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve trials from public register:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="va">q</span>,</span>
<span>  euctrresults <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from EUCTR: query=cancer&amp;age=under-18&amp;phase=phase-one&amp;status=completed</span></span>
<span><span class="co"># * Checking trials in EUCTR...</span></span>
<span><span class="co"># Retrieved overview, multiple records of 102 trial(s) from 6 page(s) to be downloaded (estimate: 10 MB)</span></span>
<span><span class="co"># (1/3) Downloading trials...</span></span>
<span><span class="co"># Note: register server cannot compress data, transfer takes longer (estimate: 100 s)</span></span>
<span><span class="co"># Download status: 6 done; 0 in progress. Total size: 8.41 Mb (100%)... done!             </span></span>
<span><span class="co"># (2/3) Converting to NDJSON (estimate: 2 s)...</span></span>
<span><span class="co"># (3/3) Importing records into database...</span></span>
<span><span class="co"># = Imported or updated 399 records on 102 trial(s)</span></span>
<span><span class="co"># * Checking results if available from EUCTR for 102 trials: </span></span>
<span><span class="co"># (1/4) Downloading results...</span></span>
<span><span class="co"># Download status: 102 done; 0 in progress. Total size: 59.71 Mb (100%)... done!             </span></span>
<span><span class="co"># Download status: 26 done; 0 in progress. Total size: 104.66 Kb (100%)... done!             </span></span>
<span><span class="co"># - extracting results (. = data, F = file[s] and data, x = none):</span></span>
<span><span class="co"># F . F F . F . . F . . . F F . . . . . . . . . . . . . . . . . . F . . . . . . F . . . </span></span>
<span><span class="co"># F . . . . . . . . . F . . . . F . . . . . F . . . . . . . . . . . </span></span>
<span><span class="co"># (2/4) Converting to NDJSON (estimate: 8 s)...</span></span>
<span><span class="co"># (3/4) Importing results into database (may take some time)...</span></span>
<span><span class="co"># (4/4) Results history: not retrieved (euctrresultshistory = FALSE)</span></span>
<span><span class="co"># = Imported or updated results for 76 trials</span></span>
<span><span class="co"># No history found in expected format.</span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 399</span></span></code></pre></div>
<p>Under the hood, EUCTR plain text and XML files from EUCTR, CTGOV, ISRCTN are converted using Javascript via <code>V8</code> in <code>R</code> into <code>NDJSON</code>, which is imported into the database collection.</p>
<ul>
<li>Analyse</li>
</ul>
<p>Tabulate the status of trials that are part of an agreed paediatric development program (paediatric investigation plan, PIP). <code>ctrdata</code> functions return a data.frame (or a tibble, if package <code>tibble</code> is loaded).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all records that have values in the fields of interest:</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"a7_trial_is_part_of_a_paediatric_investigation_plan"</span>,</span>
<span>    <span class="st">"p_end_of_trial_status"</span>,</span>
<span>    <span class="st">"a2_eudract_number"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find unique (deduplicated) trial identifiers for trials that have more than</span></span>
<span><span class="co"># one record, for example for several EU Member States or in several registers:</span></span>
<span><span class="va">uniqueids</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbFindIdsUniqueTrials.html">dbFindIdsUniqueTrials</a></span><span class="op">(</span>con <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span>
<span><span class="co"># Searching for duplicate trials... </span></span>
<span><span class="co">#  - Getting all trial identifiers (may take some time), 399 found in collection</span></span>
<span><span class="co">#  - Finding duplicates among registers' and sponsor ids...</span></span>
<span><span class="co">#  - 297 EUCTR _id were not preferred EU Member State record for 102 trials</span></span>
<span><span class="co">#  - Keeping 102 / 0 / 0 / 0 / 0 records from EUCTR / CTGOV / CTGOV2 / ISRCTN / CTIS</span></span>
<span><span class="co"># = Returning keys (_id) of 102 records in collection "some_collection_name"</span></span>
<span></span>
<span><span class="co"># Keep only unique / de-duplicated records:</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">result</span>,</span>
<span>  subset <span class="op">=</span> <span class="va">`_id`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">uniqueids</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tabulate the selected clinical trial information:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">result</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span></span>
<span>    <span class="va">p_end_of_trial_status</span>,</span>
<span>    <span class="va">a7_trial_is_part_of_a_paediatric_investigation_plan</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#                           a7_trial_is_part_of_a_paediatric_investigation_plan</span></span>
<span><span class="co"># p_end_of_trial_status      FALSE TRUE</span></span>
<span><span class="co">#   Completed                   49   21</span></span>
<span><span class="co">#   GB - no longer in EU/EEA     1    1</span></span>
<span><span class="co">#   Ongoing                      5    3</span></span>
<span><span class="co">#   Prematurely Ended            2    3</span></span>
<span><span class="co">#   Restarted                    0    1</span></span>
<span><span class="co">#   Temporarily Halted           1    1</span></span></code></pre></div>
<div id="workflow-ctgov-example">

</div>
<ul>
<li>Add records from another register (CTGOV) into the same collection</li>
</ul>
<p>Both the current and classic CTGOV website are supported by <code>ctrdata</code> since 2023-08-05:</p>
<p>The new website and API introduced in July 2023 (<a href="https://www.clinicaltrials.gov/" class="external-link uri">https://www.clinicaltrials.gov/</a>) is identified in <code>ctrdata</code> as <code>CTGOV2</code>.</p>
<p>The website and API which is now called “classic” (<a href="https://classic.clinicaltrials.gov/" class="external-link uri">https://classic.clinicaltrials.gov/</a>) is identified in <code>ctrdata</code> as <code>CTGOV</code>, and this is backwards-compatible with queries that were previously retrieved with <code>ctrdata</code>. As long as the classic website is available, <code>ctrdata</code> should work (it does not use the classic API, announced to be retired in June 2024; it is unclear if and when the classic website is retired).</p>
<p>Both use the same trial identifier (e.g., NCT01234567) for the same trial. As a consequence, queries for the same trial retrieved using <code>CTGOV</code> or <code>CTGOV2</code> overwrite any previous record for that trial, whether loaded from <code>CTGOV</code> or <code>CTGOV2</code>. Thus, only a single version (the last retrieved) will be in the collection in the user’s database.</p>
<p>Important differences exist between field names and contents of information retrieved using <code>CTGOV</code> or <code>CTGOV2</code>; see the <a href="https://prsinfo.clinicaltrials.gov/prs-xml-schemas.html" class="external-link">XML schemas for <code>CTGOV</code></a> and the <a href="https://clinicaltrials.gov/data-api/api#extapi" class="external-link">REST API for <code>CTGOV2</code></a>. For more details, call <code><a href="reference/ctrdata-registers.html">help("ctrdata-registers")</a></code>. This is one of the reasons why <code>ctrdata</code> handles the situation as if these were two different registers.</p>
<ul>
<li>Search used in this example: <a href="https://www.clinicaltrials.gov/search?cond=Neuroblastoma&amp;aggFilters=ages:child,results:with,studyType:int" class="external-link uri">https://www.clinicaltrials.gov/search?cond=Neuroblastoma&amp;aggFilters=ages:child,results:with,studyType:int</a>
</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve trials from another register:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"cond=Neuroblastoma&amp;aggFilters=ages:child,results:with,studyType:int"</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"CTGOV2"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Appears specific for CTGOV REST API 2.0</span></span>
<span><span class="co"># * Found search query from CTGOV2: cond=Neuroblastoma&amp;aggFilters=ages:child,results:with,studyType:int</span></span>
<span><span class="co"># * Checking trials using CTGOV REST API 2.0, found 99 trials</span></span>
<span><span class="co"># (1/3) Downloading in 1 batch(es) (max. 1000 trials each; estimate: 9.9 MB total)</span></span>
<span><span class="co"># Download status: 1 done; 0 in progress. Total size: 9.13 Mb (806%)... done!             </span></span>
<span><span class="co"># (2/3) Converting to NDJSON...</span></span>
<span><span class="co"># (3/3) Importing records into database...</span></span>
<span><span class="co"># JSON file #: 1 / 1                               </span></span>
<span><span class="co"># = Imported or updated 99 trial(s)</span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 99</span></span></code></pre></div>
<ul>
<li>Using an example from classic CTGOV: <a href="https://classic.clinicaltrials.gov/ct2/results?cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug" class="external-link uri">https://classic.clinicaltrials.gov/ct2/results?cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug</a>
</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve trials:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://classic.clinicaltrials.gov/ct2/results?cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Appears specific for CTGOV Classic website</span></span>
<span><span class="co"># * Found search query from CTGOV: cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug</span></span>
<span><span class="co"># * Checking trials using CTGOV Classic website...</span></span>
<span><span class="co"># Retrieved overview, records of 62 trial(s) are to be downloaded (estimate: 0.5 MB)</span></span>
<span><span class="co"># (1/3) Downloading trial file...</span></span>
<span><span class="co"># (2/3) Converting to NDJSON (estimate: 3 s)...</span></span>
<span><span class="co"># (3/3) Importing records into database...</span></span>
<span><span class="co"># = Imported or updated 62 trial(s)                </span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 62</span></span></code></pre></div>
<ul>
<li>Add records from a third register (ISRCTN) into the same collection</li>
</ul>
<p>Search used in this example: <a href="https://www.isrctn.com/search?q=neuroblastoma" class="external-link uri">https://www.isrctn.com/search?q=neuroblastoma</a></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve trials from another register:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://www.isrctn.com/search?q=neuroblastoma"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from ISRCTN: q=neuroblastoma</span></span>
<span><span class="co"># * Checking trials in ISRCTN...</span></span>
<span><span class="co"># Retrieved overview, records of 9 trial(s) are to be downloaded (estimate: 0.2 MB)</span></span>
<span><span class="co"># (1/3) Downloading trial file... </span></span>
<span><span class="co"># Download status: 1 done; 0 in progress. Total size: 93.28 Kb (100%)... done!             </span></span>
<span><span class="co"># (2/3) Converting to NDJSON (estimate: 0.05 s)...</span></span>
<span><span class="co"># (3/3) Importing records into database...</span></span>
<span><span class="co"># = Imported or updated 9 trial(s)                 </span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 9</span></span></code></pre></div>
<div id="workflow-ctis-example">

</div>
<ul>
<li>Add records from a fourth register (CTIS 🔔) into the same collection</li>
</ul>
<p>Queries in the CTIS search interface can be automatically copied to the clipboard so that a user can paste them into <code>queryterm</code>, see <a href="#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>. As of 2024-05-13, there are more than 780 trials publicly accessible in CTIS. See <a href="#documents-example">below</a> for how to download documents from CTIS.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See how many trials are in CTIS publicly accessible:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">""</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"CTIS"</span>,</span>
<span>  only.count <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 731</span></span>
<span></span>
<span><span class="co"># Retrieve trials from another register:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://euclinicaltrials.eu/app/#/search?ageGroupCode=2"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from CTIS: ageGroupCode=2</span></span>
<span><span class="co"># * Checking trials in CTIS...</span></span>
<span><span class="co"># (1/5) Downloading trials list . found 69 trials</span></span>
<span><span class="co"># (2/5) Downloading and processing part I and parts II... (estimate: 10 Mb)</span></span>
<span><span class="co"># Download status: 69 done; 0 in progress. Total size: 15.05 Mb (100%)... done!             </span></span>
<span><span class="co"># . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span></span>
<span><span class="co"># . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . </span></span>
<span><span class="co"># (3/5) Downloading and processing additional data:</span></span>
<span><span class="co"># publicevents, summary, layperson, csr, cm, inspections, publicevaluation (estimate: 5 Mb)</span></span>
<span><span class="co"># Download status: 147 done; 0 in progress. Total size: 4.06 Mb (100%)... done!             </span></span>
<span><span class="co"># 69</span></span>
<span><span class="co"># (4/5) Importing records into database...</span></span>
<span><span class="co"># (5/5) Updating with additional data: . . .       </span></span>
<span><span class="co"># = Imported / updated 69 / 69 / 69 / 1 records on 69 trial(s)</span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 69</span></span>
<span></span>
<span><span class="va">allFields</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbFindFields.html">dbFindFields</a></span><span class="op">(</span><span class="st">".*"</span>, <span class="va">db</span>, sample <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Finding fields in database collection (sampling 5 trial records)  .  .  .  .  .  .  . </span></span>
<span><span class="co"># Field names cached for this session.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">allFields</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"CTIS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">allFields</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># [1] 2557</span></span>
<span></span>
<span><span class="va">allFields</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"defer|consideration$"</span>, <span class="va">allFields</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co">#                                                                           "hasDeferrallApplied" </span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co"># "publicEvaluation.partIIEvaluationList.partIIRfiConsiderations.rfiConsiderations.consideration" </span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co">#                       "publicEvaluation.partIRfiConsiderations.rfiConsiderations.consideration" </span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co">#                  "publicEvaluation.partIRfiConsiderations.rfiConsiderations.part1Consideration" </span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co">#                  "publicEvaluation.validationRfiConsiderations.rfiConsiderations.consideration" </span></span>
<span><span class="co">#                                                                                            CTIS </span></span>
<span><span class="co">#             "publicEvaluation.validationRfiConsiderations.rfiConsiderations.part1Consideration"  </span></span>
<span></span>
<span><span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span><span class="st">"publicEvaluation.partIRfiConsiderations.rfiConsiderations.consideration"</span>, <span class="va">db</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="co"># publicEvaluation.partIRfiConsiderations.rfiConsiderations.consideration</span></span>
<span><span class="co"># In(EX)clusion criteria: An adequate definition of WOCBP or postmenopausal woman </span></span>
<span><span class="co"># is missing and should be added to the protocol. / The rationale for the treatment duration of 7 to </span></span>
<span><span class="co"># 18 weeks cannot be followed. No data are available for this short time period and nivolumab treatment. </span></span>
<span><span class="co"># The shortest duration tested so far in 1 year in adjuvant or maintenance treatment protocol. </span></span>
<span><span class="co"># The sponsor is asked to justify and substantiate his assumption that this treatment duration is </span></span>
<span><span class="co"># adequate with respective data. / E: Information regarding the special clinical conditions for </span></span>
<span><span class="co"># conducting clinical trials with minors, \nsee Article 32 Par. 1 lit e) to g) of Regulation (EU) </span></span>
<span><span class="co"># 536/2014 is missing. Please revise the protocol accordingly. So it is indicated to include the </span></span>
<span><span class="co"># patients older than 18 years first and in case of positive results the planned younger patients </span></span>
<span><span class="co"># could follow.\nStatistical Comment: The statistical analyses are missing in the trial protocol. </span></span>
<span><span class="co"># Biometric adequate is a restriction to descriptive evaluations. A sequential evaluation is </span></span>
<span><span class="co"># recommended (adults first and then children). The protocol has to be amended accordingly / </span></span>
<span><span class="co"># Discontinuation criteria for study subjects and clinical trial termination criteria are missing </span></span>
<span><span class="co"># and have to be added. Please amend. [...]</span></span>
<span></span>
<span><span class="co"># use an alternative to dbGetFieldsIntoDf()</span></span>
<span><span class="va">allData</span> <span class="op">&lt;-</span> <span class="fu">nodbi</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/nodbi/reference/docdb_query.html" class="external-link">docdb_query</a></span><span class="op">(</span>src <span class="op">=</span> <span class="va">db</span>, key <span class="op">=</span> <span class="va">db</span><span class="op">$</span><span class="va">collection</span>, query <span class="op">=</span> <span class="st">'{"ctrname":"CTIS"}'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># names of top-level data items</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">allData</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#  [1] "_id"                           "ageGroup"                      "applications"                 </span></span>
<span><span class="co">#  [4] "authorizationDate"             "authorizedPartI"               "authorizedPartsII"            </span></span>
<span><span class="co">#  [7] "coSponsors"                    "ctNumber"                      "ctrname"                      </span></span>
<span><span class="co"># [10] "ctStatus"                      "decisionDate"                  "eeaEndDate"                   </span></span>
<span><span class="co"># [13] "eeaStartDate"                  "endDateEU"                     "eudraCtInfo"                  </span></span>
<span><span class="co"># [16] "gender"                        "hasAmendmentApplied"           "hasDeferrallApplied"          </span></span>
<span><span class="co"># [19] "id"                            "initialApplicationId"          "isRmsTacitAssignment"         </span></span>
<span><span class="co"># [22] "lastUpdated"                   "memberStatesConcerned"         "mscTrialNotificationsInfoList"</span></span>
<span><span class="co"># [25] "primarySponsor"                "publicEvaluation"              "record_last_import"           </span></span>
<span><span class="co"># [28] "recruitmentStartDate"          "recruitmentStatus"             "sponsorType"                  </span></span>
<span><span class="co"># [31] "startDateEU"                   "submissionDate"                "summary"                      </span></span>
<span><span class="co"># [34] "therapeuticAreas"              "title"                         "totalNumberEnrolled"          </span></span>
<span><span class="co"># [37] "totalPartIISubjectCount"       "trialCountries"                "trialEndDate"                 </span></span>
<span><span class="co"># [40] "trialGlobalEnd"                "trialPhase"                    "trialStartDate"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">allData</span><span class="op">)</span>, <span class="st">"MB"</span><span class="op">)</span></span>
<span><span class="co"># [1] "75.6 Mb"</span></span></code></pre></div>
<div id="workflow-cross-trial-example">

</div>
<ul>
<li>Analysis across trials</li>
</ul>
<p>Show cumulative start of trials over time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use helper library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get names of all fields / variables in the collaction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="reference/dbFindFields.html">dbFindFields</a></span><span class="op">(</span><span class="st">".*"</span>, con <span class="op">=</span> <span class="va">db</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 3883</span></span>
<span></span>
<span><span class="fu"><a href="reference/dbFindFields.html">dbFindFields</a></span><span class="op">(</span><span class="st">"(start.*date)|(date.*decision)"</span>, con <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span>
<span><span class="co"># Using cache of fields.</span></span>
<span></span>
<span><span class="co"># - Get trial data</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ctrname"</span>,</span>
<span>    <span class="st">"record_last_import"</span>,</span>
<span>    <span class="co"># CTGOV</span></span>
<span>    <span class="st">"start_date"</span>,</span>
<span>    <span class="st">"overall_status"</span>,</span>
<span>    <span class="co"># CTGOV2</span></span>
<span>    <span class="st">"protocolSection.statusModule.startDateStruct.date"</span>,</span>
<span>    <span class="st">"protocolSection.statusModule.overallStatus"</span>,</span>
<span>    <span class="co"># EUCTR</span></span>
<span>    <span class="st">"n_date_of_competent_authority_decision"</span>,</span>
<span>    <span class="st">"trialInformation.recruitmentStartDate"</span>, <span class="co"># needs above: 'euctrresults = TRUE'</span></span>
<span>    <span class="st">"p_end_of_trial_status"</span>, </span>
<span>    <span class="co"># ISRCTN</span></span>
<span>    <span class="st">"trialDesign.overallStartDate"</span>,</span>
<span>    <span class="st">"trialDesign.overallEndDate"</span>,</span>
<span>    <span class="co"># CTIS</span></span>
<span>    <span class="st">"authorizedPartI.trialDetails.trialInformation.trialDuration.estimatedRecruitmentStartDate"</span>,</span>
<span>    <span class="st">"ctStatus"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># - Deduplicate trials and obtain unique identifiers </span></span>
<span><span class="co">#   for trials that have records in several registers</span></span>
<span><span class="co"># - Calculate trial start date</span></span>
<span><span class="co"># - Calculate simple status for ISRCTN</span></span>
<span><span class="co"># - Update end of trial status for EUCTR</span></span>
<span><span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`_id`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="reference/dbFindIdsUniqueTrials.html">dbFindIdsUniqueTrials</a></span><span class="op">(</span>con <span class="op">=</span> <span class="va">db</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/c_across.html" class="external-link">c_across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"(date.*decision)|(start.*date)"</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>isrctnStatus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">trialDesign.overallEndDate</span> <span class="op">&lt;</span> <span class="va">record_last_import</span>, <span class="st">"Ongoing"</span>, <span class="st">"Completed"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p_end_of_trial_status <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">p_end_of_trial_status</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">n_date_of_competent_authority_decision</span><span class="op">)</span>, <span class="st">"Ongoing"</span>, <span class="va">p_end_of_trial_status</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># - Merge fields from different registers with re-leveling</span></span>
<span><span class="va">statusValues</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"ongoing"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="co"># EUCTR</span></span>
<span>    <span class="st">"Recruiting"</span>, <span class="st">"Active"</span>, <span class="st">"Ongoing"</span>, </span>
<span>    <span class="st">"Temporarily Halted"</span>, <span class="st">"Restarted"</span>,</span>
<span>    <span class="co"># CTGOV</span></span>
<span>    <span class="st">"Active, not recruiting"</span>, <span class="st">"Enrolling by invitation"</span>, </span>
<span>    <span class="st">"Not yet recruiting"</span>, <span class="st">"ACTIVE_NOT_RECRUITING"</span>,</span>
<span>    <span class="co"># CTIS</span></span>
<span>    <span class="st">"Ongoing, recruiting"</span>, <span class="st">"Ongoing, recruitment ended"</span>, </span>
<span>    <span class="st">"Ongoing, not yet recruiting"</span>, <span class="st">"Authorised, not started"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"completed"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Completed"</span>, <span class="st">"COMPLETED"</span>, <span class="st">"Ended"</span><span class="op">)</span>,</span>
<span>  <span class="st">"other"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"GB - no longer in EU/EEA"</span>, <span class="st">"Trial now transitioned"</span>,</span>
<span>    <span class="st">"Withdrawn"</span>, <span class="st">"Suspended"</span>, <span class="st">"No longer available"</span>, </span>
<span>    <span class="st">"Terminated"</span>, <span class="st">"TERMINATED"</span>, <span class="st">"Prematurely Ended"</span>, </span>
<span>    <span class="st">"Under evaluation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">[[</span><span class="st">"state"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">result</span>, </span>
<span>  colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"overall_status"</span>, <span class="st">"p_end_of_trial_status"</span>,</span>
<span>    <span class="st">"protocolSection.statusModule.overallStatus"</span>,</span>
<span>    <span class="st">"ctStatus"</span>, <span class="st">"isrctnStatus"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  levelslist <span class="op">=</span> <span class="va">statusValues</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># - Plot example</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start</span>, colour <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Evolution over time of a set of trials"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Data from EUCTR, CTIS, ISRCTN, CTGOV, CTGOV2"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date of start (proposed or realised)"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Cumulative proportion of trials"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"Current status"</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"man/figures/README-ctrdata_across_registers.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"in"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_across_registers.png" alt="Analysis across registers"><figcaption aria-hidden="true">
Analysis across registers
</figcaption></figure><ul>
<li>Result-related trial information</li>
</ul>
<p>Analyse some simple result details (see this <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">vignette</a> for more examples):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all records that have values in any of the specified fields:</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"clinical_results.baseline.analyzed_list.analyzed.count_list.count.value"</span>,</span>
<span>    <span class="st">"clinical_results.baseline.group_list.group.title"</span>,</span>
<span>    <span class="st">"clinical_results.baseline.analyzed_list.analyzed.units"</span>,</span>
<span>    <span class="st">"number_of_arms"</span>,</span>
<span>    <span class="st">"study_design_info.allocation"</span>,</span>
<span>    <span class="st">"location.facility.name"</span>,</span>
<span>    <span class="st">"condition"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mangle to calculate:</span></span>
<span><span class="co"># - which columns with values for group counts are not labelled Total</span></span>
<span><span class="co"># - what are the numbers in each of the groups etc.</span></span>
<span> <span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    is_randomised <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">study_design_info.allocation</span> <span class="op">==</span> <span class="st">"Randomized"</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="va">study_design_info.allocation</span> <span class="op">==</span> <span class="st">"Non-Randomized"</span> <span class="op">~</span> <span class="cn">FALSE</span>, </span>
<span>      <span class="va">number_of_arms</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    which_not_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span></span>
<span>      <span class="va">clinical_results.baseline.group_list.group.title</span>, <span class="st">" / "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"Total"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    num_sites <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">location.facility.name</span>, <span class="st">" / "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    num_participants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">clinical_results.baseline.analyzed_list.analyzed.count_list.count.value</span><span class="op">[</span><span class="va">which_not_total</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    num_arms_or_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">number_of_arms</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">which_not_total</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect:</span></span>
<span><span class="co"># View(result)</span></span>
<span></span>
<span><span class="co"># Example plot:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">result</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Trials including patients with a neuroblastoma"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"ClinicalTrials.Gov, trials with results"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">num_sites</span>,</span>
<span>      y <span class="op">=</span> <span class="va">num_participants</span>,</span>
<span>      size <span class="op">=</span> <span class="va">num_arms_or_groups</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">is_randomised</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Number of sites"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total number of participants"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"Randomised?"</span>, </span>
<span>    size <span class="op">=</span> <span class="st">"# Arms / groups"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"man/figures/README-ctrdata_results_neuroblastoma.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"in"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_results_neuroblastoma.png" alt="Neuroblastoma trials"><figcaption aria-hidden="true">
Neuroblastoma trials
</figcaption></figure><div id="documents-example">

</div>
<ul>
<li>Download documents: retrieve protocols, statistical analysis plans and other documents into the local folder <code>./files-.../</code>
</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### EUCTR document files can be downloaded when results are requested</span></span>
<span><span class="co"># All files are downloaded and saved (documents.regexp is not used) </span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"query=cancer&amp;age=under-18&amp;phase=phase-one"</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"EUCTR"</span>,</span>
<span>  euctrresults <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-euctr/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from EUCTR: query=cancer&amp;age=under-18&amp;phase=phase-one</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># Created directory ./files-euctr/</span></span>
<span><span class="co"># Downloading trials...</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># = Imported or updated results for 121 trials</span></span>
<span><span class="co"># = documents saved in './files-euctr'</span></span>
<span></span>
<span></span>
<span><span class="co">### CTGOV files are downloaded, here corresponding to the default of </span></span>
<span><span class="co"># documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|ctalett|lay|^[0-9]+ "</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"cond=Neuroblastoma&amp;type=Intr&amp;recrs=e&amp;phase=1&amp;u_prot=Y&amp;u_sap=Y&amp;u_icf=Y"</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"CTGOV"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctgov/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from CTGOV: cond=Neuroblastoma&amp;type=Intr&amp;recrs=e&amp;phase=1&amp;u_prot=Y&amp;u_sap=Y&amp;u_icf=Y</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># Downloading documents into 'documents.path' = ./files-ctgov/</span></span>
<span><span class="co"># - Created directory ./files-ctgov</span></span>
<span><span class="co"># Applying 'documents.regexp' to 16 documents</span></span>
<span><span class="co"># Downloading 11 missing documents:</span></span>
<span><span class="co"># Download status: 11 done; 0 in progress. Total size: 39.48 Mb (100%)... done!             </span></span>
<span><span class="co"># Newly saved 11 document(s) for 8 trial(s); 0 document(s) for 0 trial(s) already existed</span></span>
<span></span>
<span></span>
<span><span class="co">### CTGOV2 files are downloaded, here corresponding to the default of </span></span>
<span><span class="co"># documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|ctalett|lay|^[0-9]+ "</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://clinicaltrials.gov/search?cond=neuroblastoma&amp;aggFilters=phase:1,results:with"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctgov2/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from CTGOV2: cond=neuroblastoma&amp;aggFilters=phase:1,results:with</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># * Downloading documents into 'documents.path' = ./files-ctgov2/</span></span>
<span><span class="co"># - Created directory ./files-ctgov2</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 35 documents</span></span>
<span><span class="co"># - Downloading 30 missing documents</span></span>
<span><span class="co"># Download status: 30 done; 0 in progress. Total size: 75.14 Mb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 30 document(s) for 22 trial(s); 0 document(s) for 0 trial(s) already </span></span>
<span><span class="co"># existed in ./files-ctgov2</span></span>
<span></span>
<span></span>
<span><span class="co">### ISRCTN files are downloaded, here corresponding to the default of </span></span>
<span><span class="co"># documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|ctalett|lay|^[0-9]+ "</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://www.isrctn.com/search?q=alzheimer"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-isrctn/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from ISRCTN: q=alzheimer</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># * Downloading documents into 'documents.path' = ./files-isrctn/</span></span>
<span><span class="co"># - Created directory /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-isrctn</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 41 documents</span></span>
<span><span class="co"># - Downloading 26 missing documents</span></span>
<span><span class="co"># Download status: 26 done; 0 in progress. Total size: 12.83 Mb (100%)... done!             </span></span>
<span><span class="co"># Download status: 2 done; 0 in progress. Total size: 6.56 Kb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 24 document(s) for 12 trial(s); 0 document(s) for 0 trial(s) already </span></span>
<span><span class="co"># existed in /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-isrctn</span></span>
<span><span class="co"># = Imported or updated 299 trial(s)</span></span>
<span><span class="co"># existed in ./files-isrctn</span></span>
<span></span>
<span></span>
<span><span class="co">### CTIS files are downloaded, here corresponding to the default of </span></span>
<span><span class="co"># documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|ctalett|lay|^[0-9]+ "</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://euclinicaltrials.eu/app/#/search?ageGroupCode=2"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctis/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from CTIS: ageGroupCode=2</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># * Downloading documents into 'documents.path' = ./files-ctis/</span></span>
<span><span class="co"># - Created directory /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-ctis</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 5757 documents</span></span>
<span><span class="co"># - Downloading 577 missing documents</span></span>
<span><span class="co"># Download status: 577 done; 0 in progress. Total size: 338.89 Mb (100%)... done!             </span></span>
<span><span class="co"># Download status: 68 done; 0 in progress. Total size: 1020 b (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 509 document(s) for 47 trial(s); 0 document(s) for 0 trial(s) already </span></span>
<span><span class="co"># existed in./files-ctis</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tests">Tests<a class="anchor" aria-label="anchor" href="#tests"></a>
</h2>
<p>See also <a href="https://app.codecov.io/gh/rfhb/ctrdata/tree/master/R" class="external-link uri">https://app.codecov.io/gh/rfhb/ctrdata/tree/master/R</a></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/run_test_dir.html" class="external-link">test_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># test_ctrdata_ctrfindactivesubstance.R    4 tests OK 1.6s</span></span>
<span><span class="co"># test_ctrdata_duckdb_ctgov2.R..   50 tests OK 2.4s</span></span>
<span><span class="co"># test_ctrdata_duckdb_ctis.R....  172 tests OK 15.2s</span></span>
<span><span class="co"># test_ctrdata_mongo_local_ctgov.R   51 tests OK 57.7s</span></span>
<span><span class="co"># test_ctrdata_other_functions.R   64 tests OK 3.8s</span></span>
<span><span class="co"># test_ctrdata_postgres_ctgov2.R   50 tests OK 2.6s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctgov.R...   52 tests OK 56.0s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctgov2.R..   50 tests OK 2.3s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctis.R....  194 tests OK 12.5s</span></span>
<span><span class="co"># test_ctrdata_sqlite_euctr.R...  105 tests OK 1.3s</span></span>
<span><span class="co"># test_ctrdata_sqlite_isrctn.R..   38 tests OK 21.4s</span></span>
<span><span class="co"># test_euctr_error_sample.R.....    8 tests OK 0.9s</span></span>
<span><span class="co"># All ok, 838 results (38m 48.8s)</span></span>
<span></span>
<span><span class="fu">covr</span><span class="fu">::</span><span class="fu"><a href="http://covr.r-lib.org/reference/package_coverage.html" class="external-link">package_coverage</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"."</span>, type <span class="op">=</span> <span class="st">"tests"</span><span class="op">)</span></span>
<span><span class="co"># ctrdata Coverage: 93.68%</span></span>
<span><span class="co"># R/zzz.R: 80.95%</span></span>
<span><span class="co"># R/ctrRerunQuery.R: 89.16%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbEuctr.R: 90.03%</span></span>
<span><span class="co"># R/utils.R: 90.89%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbIsrctn.R: 92.11%</span></span>
<span><span class="co"># R/dbGetFieldsIntoDf.R: 93.06%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbCtgov2.R: 94.05%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDb.R: 94.12%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbCtis.R: 94.13%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbCtgov.R: 95.04%</span></span>
<span><span class="co"># R/dbFindFields.R: 95.24%</span></span>
<span><span class="co"># R/ctrGetQueryUrl.R: 96.00%</span></span>
<span><span class="co"># R/ctrOpenSearchPagesInBrowser.R: 97.22%</span></span>
<span><span class="co"># R/dfMergeVariablesRelevel.R: 97.30%</span></span>
<span><span class="co"># R/dfTrials2Long.R: 97.35%</span></span>
<span><span class="co"># R/dbFindIdsUniqueTrials.R: 97.77%</span></span>
<span><span class="co"># R/dfName2Value.R: 98.61%</span></span>
<span><span class="co"># R/ctrFindActiveSubstanceSynonyms.R: 100.00%</span></span>
<span><span class="co"># R/dbQueryHistory.R: 100.00%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="future-features">Future features<a class="anchor" aria-label="anchor" href="#future-features"></a>
</h2>
<ul>
<li><p>See project outline <a href="https://github.com/users/rfhb/projects/1" class="external-link uri">https://github.com/users/rfhb/projects/1</a></p></li>
<li><p>Canonical definitions, filters, calculations are in the works (since August 2023) for data mangling and analyses across registers, e.g. to define study population, identify interventional trials, calculate study duration; public collaboration on these canonical scripts will speed up harmonising analyses.</p></li>
<li><p>Merge results-related fields retrieved from different registers, such as corresponding endpoints (work not yet started). The challenge is the incomplete congruency and different structure of data fields.</p></li>
<li><p>Authentication, expected to be required by CTGOV2; specifications not yet known (work not yet started).</p></li>
<li><p>Explore further registers such as <a href="https://trialsearch.who.int/" class="external-link">ICTRP</a> (authentication needed), <a href="https://rctportal.niph.go.jp/" class="external-link">JPRN</a>, <a href="https://jrct.niph.go.jp/" class="external-link">jRCT</a>, <a href="https://www.umin.ac.jp/ctr/" class="external-link">UMIN-CTR</a>, ChiCTR (exploration is continually ongoing; added value, terms and conditions for programmatic access vary; no clear roadmap is established yet).</p></li>
<li><p><del>Retrieve previous versions of protocol- or results-related information. The challenges include, historic versions can only be retrieved one-by-one, do not include results, or are not in structured format.</del> (functionality available with version 1.17.2.9000 to the extent that seems reasonably possible at this time, namely for protocol-related information for CTIS and for protocol- and results-related information in CTGOV2)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<ul>
<li><p>Data providers and curators of the clinical trial registers. Please review and respect their copyrights and terms and conditions, see <code>ctrOpenSearchPagesInBrowser(copyright = TRUE)</code>.</p></li>
<li><p>Package <code>ctrdata</code> has been made possible building on the work done for <a href="https://www.r-project.org/" class="external-link">R</a>, <a href="https://cran.r-project.org/package=clipr" class="external-link">clipr</a>. <a href="https://cran.r-project.org/package=curl" class="external-link">curl</a>, <a href="https://cran.r-project.org/package=dplyr" class="external-link">dplyr</a>, <a href="https://cran.r-project.org/package=duckdb" class="external-link">duckdb</a>, <a href="https://cran.r-project.org/package=httr" class="external-link">httr</a>, <a href="https://cran.r-project.org/package=jqr" class="external-link">jqr</a>, <a href="https://cran.r-project.org/package=jsonlite" class="external-link">jsonlite</a>, <a href="https://cran.r-project.org/package=lubridate" class="external-link">lubridate</a>, <a href="https://cran.r-project.org/package=mongolite" class="external-link">mongolite</a>, <a href="https://cran.r-project.org/package=nodbi" class="external-link">nodbi</a>, <a href="https://cran.r-project.org/package=RPostgres" class="external-link">RPostgres</a>, <a href="https://CRAN.R-project.org/package=RSQLite" class="external-link">RSQLite</a>, <a href="https://cran.r-project.org/package=rvest" class="external-link">rvest</a>, <a href="https://cran.r-project.org/package=stringi" class="external-link">stringi</a> and <a href="https://cran.r-project.org/package=xml2" class="external-link">xml2</a>.</p></li>
</ul>
<div class="section level3">
<h3 id="issues-and-notes">Issues and notes<a class="anchor" aria-label="anchor" href="#issues-and-notes"></a>
</h3>
<ul>
<li><p>Please file issues and bugs <a href="https://github.com/rfhb/ctrdata/issues" class="external-link">here</a>. Also check out how to handle some of the closed issues, e.g. on <a href="https://github.com/rfhb/ctrdata/issues/22" class="external-link">C stack usage too close to the limit</a> and on a <a href="https://github.com/rfhb/ctrdata/issues/19#issuecomment-820127139" class="external-link">SSL certificate problem: unable to get local issuer certificate</a></p></li>
<li><p>Information in trial registers may not be fully correct; see for example <a href="https://doi.org/10.1136/bmj.k1452" class="external-link">this publication on CTGOV</a>.</p></li>
<li><p>No attempts were made to harmonise field names between registers (nevertheless, <code><a href="reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel()</a></code> can be used to merge and map several variables / fields into one).</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="trial-records-json-in-databases">Trial records’ JSON in databases<a class="anchor" aria-label="anchor" href="#trial-records-json-in-databases"></a>
</h2>
<div class="section level3">
<h3 id="postgresql">PostgreSQL<a class="anchor" aria-label="anchor" href="#postgresql"></a>
</h3>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_json_postgresql.jpg" alt="Example JSON representation in PostgreSQL"><figcaption aria-hidden="true">
Example JSON representation in PostgreSQL
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="mongodb">MongoDB<a class="anchor" aria-label="anchor" href="#mongodb"></a>
</h3>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_json_mongodb.jpg" alt="Example JSON representation in MongoDB"><figcaption aria-hidden="true">
Example JSON representation in MongoDB
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="sqlite">SQLite<a class="anchor" aria-label="anchor" href="#sqlite"></a>
</h3>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_json_sqlite.jpg" alt="Example JSON representation in SQLite"><figcaption aria-hidden="true">
Example JSON representation in SQLite
</figcaption></figure>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ralf Herold <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8148-6748" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="table-of-contents">
<h2 data-toc-skip>Table of contents</h2>
<ul class="list-unstyled">
<li><nav id="toc"></nav></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ralf Herold.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
