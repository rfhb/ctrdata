<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Retrieve and Analyze Clinical Trials in Public Registers ‚Ä¢ ctrdata</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Retrieve and Analyze Clinical Trials in Public Registers">
<meta name="description" content="A system for querying, retrieving and analyzing protocol- and results-related information on clinical trials from four public registers, the European Union Clinical Trials Register (EUCTR, &lt;https://www.clinicaltrialsregister.eu/&gt;), ClinicalTrials.gov (&lt;https://clinicaltrials.gov/&gt; and also translating queries the retired classic interface), the ISRCTN (&lt;http://www.isrctn.com/&gt;) and the European Union Clinical Trials Information System (CTIS, &lt;https://euclinicaltrials.eu/&gt;). Trial information is downloaded, converted and stored in a database (PostgreSQL, SQLite, DuckDB or MongoDB; via package nodbi). Documents in registers associated with trials can also be downloaded. Other functions implement trial concepts canonically across registers, identify deduplicated records, easily find and extract variables (fields) of interest even from complex nested data as used by the registers, merge variables and update queries. The package can be used for meta-analysis and trend-analysis of the design and conduct as well as of the results of clinical trials across registers.">
<meta property="og:description" content="A system for querying, retrieving and analyzing protocol- and results-related information on clinical trials from four public registers, the European Union Clinical Trials Register (EUCTR, &lt;https://www.clinicaltrialsregister.eu/&gt;), ClinicalTrials.gov (&lt;https://clinicaltrials.gov/&gt; and also translating queries the retired classic interface), the ISRCTN (&lt;http://www.isrctn.com/&gt;) and the European Union Clinical Trials Information System (CTIS, &lt;https://euclinicaltrials.eu/&gt;). Trial information is downloaded, converted and stored in a database (PostgreSQL, SQLite, DuckDB or MongoDB; via package nodbi). Documents in registers associated with trials can also be downloaded. Other functions implement trial concepts canonically across registers, identify deduplicated records, easily find and extract variables (fields) of interest even from complex nested data as used by the registers, merge variables and update queries. The package can be used for meta-analysis and trend-analysis of the design and conduct as well as of the results of clinical trials across registers.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ctrdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.21.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/ctrdata_install.html">Install R package ctrdata</a></li>
    <li><a class="dropdown-item" href="articles/ctrdata_retrieve.html">Retrieve clinical trial information</a></li>
    <li><a class="dropdown-item" href="articles/ctrdata_summarise.html">Summarise and analyse clinical trial information</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rfhb/ctrdata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p><a href="#main-features">Main features</a> ‚Ä¢ <a href="#references">References</a> ‚Ä¢ <a href="#installation">Installation</a> ‚Ä¢ <a href="#overview-of-functions-in-ctrdata">Overview</a> ‚Ä¢ <a href="#databases-for-use-with-ctrdata">Databases</a> ‚Ä¢ <a href="#data-model-of-ctrdata">Data model</a> ‚Ä¢ <a href="#example-workflow">Example workflow</a> ‚Ä¢ <a href="#workflow-cross-trial-example">Analysis across trials</a> ‚Ä¢ <a href="#tests">Tests</a> ‚Ä¢ <a href="#acknowledgements">Acknowledgements</a> ‚Ä¢ <a href="#future-features">Future</a></p>
<div class="section level1">
<div class="page-header"><h1 id="ctrdata-for-aggregating-and-analysing-clinical-trials">ctrdata for aggregating and analysing clinical trials<a class="anchor" aria-label="anchor" href="#ctrdata-for-aggregating-and-analysing-clinical-trials"></a>
</h1></div>
<p>The package <code>ctrdata</code> provides functions for retrieving (downloading), aggregating and analysing clinical trials using information (structured protocol and result data, as well as documents) from public registers. It can be used with the</p>
<ul>
<li>EU Clinical Trials Register (‚ÄúEUCTR‚Äù, <a href="https://www.clinicaltrialsregister.eu/" class="external-link uri">https://www.clinicaltrialsregister.eu/</a>)</li>
<li>EU Clinical Trials Information System (‚ÄúCTIS‚Äù, <a href="https://euclinicaltrials.eu/" class="external-link uri">https://euclinicaltrials.eu/</a>, see <a href="#workflow-ctis-example">example</a>)</li>
<li>ClinicalTrials.gov (‚ÄúCTGOV2‚Äù, see <a href="#workflow-ctgov-example">example</a>)</li>
<li>ISRCTN Registry (<a href="https://www.isrctn.com/" class="external-link uri">https://www.isrctn.com/</a>)</li>
</ul>
<p>The motivation is to investigate the design and conduct of trials of interest, to describe their trends and availability for patients and to facilitate using their detailed results for research and meta-analyses. <code>ctrdata</code> is a package for the <a href="https://www.r-project.org/" class="external-link">R</a> system, but other systems and tools can use the databases created with this package. This README was reviewed on 2025-03-09 for version 1.21.0.</p>
<div class="section level2">
<h2 id="main-features">Main features<a class="anchor" aria-label="anchor" href="#main-features"></a>
</h2>
<ul>
<li><p>Protocol- and results-related trial information is easily downloaded: Users define a query in a register‚Äôs web interface, then copy the URL and enter it into <code>ctrdata</code> which retrieves in one go all trials found. A <a href="#id_2-script-to-automatically-copy-users-query-from-web-browser">script</a> can automate copying the query URL from all registers. Personal annotations can be made when downloading trials. Also, <a href="#documents-example">trial documents</a> and <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html#analysing-sample-size-using-historic-versions-of-trial-records">historic versions</a> as available in registers on trials can be downloaded.</p></li>
<li><p>Downloaded trial information is transformed and stored in a collection of a document-centric database, for fast and offline access. Information from different registers can be accumulated in a single collection. Uses <code>DuckDB</code>, <code>PostgreSQL</code>, <code>RSQLite</code> or <code>MongoDB</code>, via R package <code>nodbi</code>: see section <a href="#databases-that-can-be-used-with-ctrdata">Databases</a> below. Interactively browse through trial structure and data. Easily re-run any previous query in a collection to retrieve and update trial records.</p></li>
<li><p>For analyses, convenience functions in <code>ctrdata</code> implement canonical <a href="https://rfhb.github.io/ctrdata/reference/ctrdata-trial-concepts.html">trial concepts</a> to simplify analyses across registers üîî, allow find synonyms of an active substance, identify unique (de-duplicated) trial records across all registers, to merge and recode fields as well as to easily access deeply-nested fields. Analysis can be done with <code>R</code> (see <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">vignette</a>) or other systems, using the <code>JSON</code>-<a href="#trial-records-in-databases">structured information in the database</a>.</p></li>
</ul>
<p>Remember to respect the registers‚Äô terms and conditions (see <code>ctrOpenSearchPagesInBrowser(copyright = TRUE)</code>). Please cite this package in any publication as follows: ‚ÄúRalf Herold (2025). <em>ctrdata: Retrieve and Analyze Clinical Trials in Public Registers.</em> R package version 1.21.0, <a href="https://cran.r-project.org/package=ctrdata" class="external-link uri">https://cran.r-project.org/package=ctrdata</a>‚Äù.</p>
<!--
&#10;
``` r
citation("ctrdata")
&#10;# find publications
utils::browseURL("https://scholar.google.com/scholar?hl=en&as_sdt=0,5&q=%22ctrdata%22")
&#10;# mentioned but not used in
# * Sciannameo et al. (2024) Information Extraction from Medical Case Reports Using OpenAI InstructGPT. Computer Methods and Programs in Biomedicine [https://doi.org/10.1016/j.cmpb.2024.108326](https://doi.org/10.1016/j.cmpb.2024.108326)
&#10;```
&#10;-->
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Package <code>ctrdata</code> has been used for unpublished works and for these publications:</p>
<ul>
<li>Alzheimer‚Äôs disease Horizon Scanning Report (2024) <a href="https://www.ema.europa.eu/en/documents/report/alzheimers-disease-eu-horizon-scanning-report_en.pdf#page=10" class="external-link">PDF file, p 10</a> üîî</li>
<li>Kundu et al.¬†(2024) Analysis of Factors Influencing Enrollment Success in Hematology Malignancy Cancer Clinical Trials (2008-2023). Blood Meeting Abstracts <a href="https://doi.org/10.1182/blood-2024-207446" class="external-link uri">https://doi.org/10.1182/blood-2024-207446</a> üîî</li>
<li>Lasch et al.¬†(2022) The Impact of COVID‚Äê19 on the Initiation of Clinical Trials in Europe and the United States. Clinical Pharmacology &amp; Therapeutics <a href="https://doi.org/10.1002/cpt.2534" class="external-link uri">https://doi.org/10.1002/cpt.2534</a>
</li>
<li>Sood et al.¬†(2022) Managing the Evidence Infodemic: Automation Approaches Used for Developing NICE COVID-19 Living Guidelines. medRxiv <a href="https://doi.org/10.1101/2022.06.13.22276242" class="external-link uri">https://doi.org/10.1101/2022.06.13.22276242</a>
</li>
<li>Blogging on <a href="https://paediatricdata.eu/innovation-coming-to-paediatric-research/" class="external-link">Innovation coming to paediatric research</a>
</li>
<li>Cancer Research UK (2017) <a href="https://www.cancerresearchuk.org/about-us/we-develop-policy/policy-publications-and-research-tenders#Policy_publications4" class="external-link">The impact of collaboration: The value of UK medical research to EU science and health</a>
</li>
<li>EMA (2017) Results of juvenile animal studies (JAS) and impact on anti-cancer medicine development and use in children <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/results-juvenile-animal-studies-jas-and-impact-anti-cancer-medicine-development-and-use-children_en.pdf#page=34" class="external-link">PDF file, p 34</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="id_1-install-package-ctrdata-in-r">1. Install package <code>ctrdata</code> in R<a class="anchor" aria-label="anchor" href="#id_1-install-package-ctrdata-in-r"></a>
</h3>
<p>Package <code>ctrdata</code> is <a href="https://cran.r-project.org/package=ctrdata" class="external-link">on CRAN</a> and <a href="https://github.com/rfhb/ctrdata" class="external-link">on GitHub</a>. Within <a href="https://www.r-project.org/" class="external-link">R</a>, use the following commands to install package <code>ctrdata</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install CRAN version:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ctrdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternatively, install development version:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rfhb/ctrdata"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These commands also install the package‚Äôs dependencies (<code>jsonlite</code>, <code>httr</code>, <code>curl</code>, <code>clipr</code>, <code>xml2</code>, <code>nodbi</code>, <code>stringi</code>, <code>tibble</code>, <code>lubridate</code>, <code>jqr</code>, <code>dplyr</code>, <code>zip</code>, <code>readr</code>, <code>digest</code>, <code>countrycode</code>, <code>htmlwidgets</code>, <code>stringdist</code> and <code>V8</code>).</p>
</div>
<div class="section level3">
<h3 id="id_2-script-to-automatically-copy-users-query-from-web-browser">2. Script to automatically copy user‚Äôs query from web browser<a class="anchor" aria-label="anchor" href="#id_2-script-to-automatically-copy-users-query-from-web-browser"></a>
</h3>
<p>Optional; works with all registers supported by <code>ctrdata</code> and is recommended for CTIS so that its URL in the web browser reflects the user‚Äôs parameters for querying this register.</p>
<p>In the web browser, install the <a href="https://www.tampermonkey.net/" class="external-link">Tampermonkey browser extension</a>, click on ‚ÄúNew user script‚Äù and then on ‚ÄúTools‚Äù, enter into ‚ÄúImport from URL‚Äù this URL: <a href="https://raw.githubusercontent.com/rfhb/ctrdata/master/tools/ctrdataURLcopier.js" class="external-link"><code>https://raw.githubusercontent.com/rfhb/ctrdata/master/tools/ctrdataURLcopier.js</code></a> and then click on ‚ÄúInstall‚Äù.</p>
<p>The browser extension can be disabled and enabled by the user. When enabled, the URLs to all user‚Äôs queries in the registers are automatically copied to the clipboard and can be pasted into the <code>queryterm = ...</code> parameter of function <a href="https://rfhb.github.io/ctrdata/reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a>.</p>
<p>Additionally, this script retrieves results for <code>CTIS</code> when opening search URLs such as <a href="https://euclinicaltrials.eu/ctis-public/search#searchCriteria=%7B%22status%22:%5B3,4%5D%7D" class="external-link">https://euclinicaltrials.eu/ctis-public/search#searchCriteria={‚Äústatus‚Äù:[3,4]}</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="overview-of-functions-in-ctrdata">Overview of functions in <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#overview-of-functions-in-ctrdata"></a>
</h2>
<p>The functions are listed in the approximate order of use in a user‚Äôs workflow (in bold, main functions). See also the <a href="https://rfhb.github.io/ctrdata/reference/index.html">package documentation overview</a>.</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr>
<th>Function name</th>
<th>Function purpose</th>
</tr></thead>
<tbody>
<tr>
<td><code><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser()</a></code></td>
<td>Open search pages of registers or execute search in web browser</td>
</tr>
<tr>
<td><code><a href="reference/ctrFindActiveSubstanceSynonyms.html">ctrFindActiveSubstanceSynonyms()</a></code></td>
<td>Find synonyms and alternative names for an active substance</td>
</tr>
<tr>
<td><code><a href="reference/ctrGenerateQueries.html">ctrGenerateQueries()</a></code></td>
<td><strong>From simple user parameters, generates queries for each register to find trials of interest</strong></td>
</tr>
<tr>
<td><code><a href="reference/ctrGetQueryUrl.html">ctrGetQueryUrl()</a></code></td>
<td>Import from clipboard the URL of a search in one of the registers</td>
</tr>
<tr>
<td><code><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a></code></td>
<td><strong>Retrieve (download) or update, and annotate, information on trials from a register and store in a collection in a database</strong></td>
</tr>
<tr>
<td><code><a href="reference/ctrShowOneTrial.html">ctrShowOneTrial()</a></code></td>
<td>üîî Show full structure and all data of a trial, interactively select fields of interest for <code><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a></code>
</td>
</tr>
<tr>
<td><code><a href="reference/dbQueryHistory.html">dbQueryHistory()</a></code></td>
<td>Show the history of queries that were downloaded into the collection</td>
</tr>
<tr>
<td><code><a href="reference/dbFindIdsUniqueTrials.html">dbFindIdsUniqueTrials()</a></code></td>
<td><strong>Get the identifiers of de-duplicated trials in the collection</strong></td>
</tr>
<tr>
<td><code><a href="reference/dbFindFields.html">dbFindFields()</a></code></td>
<td>Find names of variables (fields) in the collection</td>
</tr>
<tr>
<td><code><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a></code></td>
<td><strong>Create a data frame (or tibble) from trial records in the database with the specified fields</strong></td>
</tr>
<tr>
<td><code><a href="reference/dfTrials2Long.html">dfTrials2Long()</a></code></td>
<td>Transform the data.frame from <code><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a></code> into a long name-value data.frame, including deeply nested fields</td>
</tr>
<tr>
<td><code><a href="reference/dfName2Value.html">dfName2Value()</a></code></td>
<td>From a long name-value data.frame, extract values for variables (fields) of interest (e.g., endpoints)</td>
</tr>
<tr>
<td><code><a href="reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel()</a></code></td>
<td>Merge variables into a new variable, optionally map values to a new set of levels</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="databases-for-use-with-ctrdata">Databases for use with <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#databases-for-use-with-ctrdata"></a>
</h2>
<p>Package <code>ctrdata</code> retrieves trial information and stores it in a database collection, which has to be given as a connection object to parameter <code>con</code> for several <code>ctrdata</code> functions. This connection object is created almost identically for the four database backends supported by <code>ctrdata</code>, as shown in the table. For a speed comparison, see the <a href="https://github.com/ropensci/nodbi#benchmark" class="external-link">nodbi documentation</a>.</p>
<p>Besides <code>ctrdata</code> functions below, such a connection object can be used with functions of other packages, such as <code>nodbi</code> (see last row in table) or, in case of MongoDB as database backend, <code>mongolite</code> (see vignettes).</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr>
<th>Purpose</th>
<th>Function call</th>
</tr></thead>
<tbody>
<tr>
<td>Create <strong>SQLite</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_sqlite(dbname = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr>
<td>Create <strong>DuckDB</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_duckdb(dbdir = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr>
<td>Create <strong>MongoDB</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_mongo(db = "name_of_my_database", collection = "name_of_my_collection")</code></td>
</tr>
<tr>
<td>Create <strong>PostgreSQL</strong> database connection</td>
<td><code>dbc &lt;- nodbi::src_postgres(dbname = "name_of_my_database"); dbc[["collection"]] &lt;- "name_of_my_collection"</code></td>
</tr>
<tr>
<td>Use connection with <code>ctrdata</code> functions</td>
<td><code>ctrdata::{ctrLoadQueryIntoDb, dbQueryHistory, dbFindIdsUniqueTrials, dbFindFields, dbGetFieldsIntoDf}(con = dbc, ...)</code></td>
</tr>
<tr>
<td>Use connection with <code>nodbi</code> functions</td>
<td>e.g., <code>nodbi::docdb_query(src = dbc, key = dbc$collection, ...)</code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="data-model-of-ctrdata">Data model of <code>ctrdata</code>
<a class="anchor" aria-label="anchor" href="#data-model-of-ctrdata"></a>
</h2>
<p>Package <code>ctrdata</code> uses the data models that are implicit in data as retrieved from the different registers. No mapping is provided for any register‚Äôs data model to a putative target data model. The reasons include that registers‚Äô data models are continually evolving over time, that only few data fields have similar values and meaning between registers, and that the retrieved public data may not correspond to the registers‚Äô internal data model. The structure of data for a specific trial can interactively be inspected and searched using function, see the section <a href="#workflow-data-model">below</a>.</p>
<p>Thus, the handling of data from different models of registers is to be done at the time of analysis. This approach allows a high level of flexibility, transparency and reproducibility. To support analyses, <code>ctrdata</code> (from version 1.21.0) provides functions that calculate concepts of clinical trials across registers, which are commonly used in analyses, such as start dates, age groups and statistical tests of results. See <a href="https://rfhb.github.io/ctrdata/reference/ctrdata-trial-concepts.html">help(ctrdata-trial-concepts)</a> and the section <a href="#workflow-cross-trial-example">Analysis across trials</a> in the example workflow below. For further analyses, see examples of function <a href="https://rfhb.github.io/ctrdata/reference/dfMergeVariablesRelevel.html">dfMergeVariablesRelevel()</a> on how to align related fields from different registers for a joint analysis.</p>
<p>In any of the <a href="https://rfhb.github.io/ctrdata/index.html#databases-for-use-with-ctrdata">databases</a>, one clinical trial is one document, corresponding to one row in a <code>SQLite</code>, <code>PostgreSQL</code> or <code>DuckDB</code> table, and to one document in a <code>MongoDB</code> collection. These <code>NoSQL</code> backends allow documents to have different structures, which is used here to accommodate the different models of data retrieved from the registers. Package <code>ctrdata</code> stores in every such document:</p>
<ul>
<li>field <code>_id</code> with the trial identification as provided by the register from which it was retrieved</li>
<li>field <code>ctrname</code> with the name of the register (<code>EUCTR</code>, <code>CTGOV</code>, <code>CTGOV2</code>, <code>ISRCTN</code>, <code>CTIS</code>) from which that trial was retrieved</li>
<li>field <code>record_last_import</code> with the date and time when that document was last updated using <code><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb()</a></code>
</li>
<li>only for <code>CTGOV2</code>: object <code>history</code> with a historic version of the trial and with <code>history_version</code>, which contains the fields <code>version_number</code> (starting from 1) and <code>version_date</code>
</li>
<li>all original fields as provided by the register for that trial (see examples <a href="https://rfhb.github.io/ctrdata/index.html#trial-records-json-in-databases">below</a>)</li>
</ul>
<p>For visualising the data structure for a trial, see this <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html#analysing-nested-fields-such-as-trial-results">vignette section</a>.</p>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ul>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_install.html">Install R package ctrdata</a></li>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_retrieve.html">Retrieve clinical trial information</a></li>
<li><a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">Summarise and analyse clinical trial information</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-workflow">Example workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h2>
<p>The aim is to download protocol-related trial information and tabulate the trials‚Äô status of conduct.</p>
<ul>
<li>Attach package <code>ctrdata</code>:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=ctrdata" class="external-link">ctrdata</a></span><span class="op">)</span></span></code></pre></div>
<ul>
<li>See help to get started with <code>ctrdata</code>:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"ctrdata"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Information on trial registers and how they can be used with <code>ctrdata</code> (last updated 2025-03-09):</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"ctrdata-registers"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Trial concepts across registers provided by <code>ctrdata</code> (new 2025-03-09 üîî):</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="st">"ctrdata-trial-concepts"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Open registers‚Äô advanced search pages in browser:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Please review and respect register copyrights:</span></span>
<span><span class="fu"><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser</a></span><span class="op">(</span>copyright <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Adjust search parameters and execute search in browser</p></li>
<li><p>When trials of interest are listed in browser, <em>copy the address from the browser‚Äôs address bar to the clipboard</em> (you can automate this, see <a href="#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>)</p></li>
<li><p>Search used in this example: <a href="https://www.clinicaltrialsregister.eu/ctr-search/search?query=neuroblastoma&amp;phase=phase-two&amp;age=children" class="external-link uri">https://www.clinicaltrialsregister.eu/ctr-search/search?query=neuroblastoma&amp;phase=phase-two&amp;age=children</a></p></li>
<li><p>Get address from clipboard:</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ctrGetQueryUrl.html">ctrGetQueryUrl</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># * Using clipboard content as register query URL: https://www.clinicaltrialsregister.eu/</span></span>
<span><span class="co"># ctr-search/search?query=neuroblastoma&amp;phase=phase-two&amp;age=children</span></span>
<span><span class="co"># * Found search query from EUCTR: query=neuroblastoma&amp;phase=phase-two&amp;age=children</span></span>
<span></span>
<span><span class="va">q</span></span>
<span><span class="co">#                                         query-term query-register</span></span>
<span><span class="co"># 1 query=neuroblastoma&amp;phase=phase-two&amp;age=children          EUCTR</span></span></code></pre></div>
<p>üîî Queries in the trial registers can automatically copied to the clipboard (including for ‚ÄúCTIS‚Äù, where the URL otherwise does not show the user‚Äôs query) using the solution <a href="#id_3-script-to-automatically-copy-users-query-from-web-browser">here</a>.</p>
<ul>
<li>Retrieve protocol-related information, transform and save to database:</li>
</ul>
<p>For loading the trial information, first a database collection is specified, using <code>nodbi</code> (see above for how to specify <code>PostgreSQL</code>, <code>RSQlite</code>, <code>DuckDB</code> or <code>MongoDB</code> as backend, see section <a href="#databases-that-can-be-used-with-ctrdata">Databases</a>):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Connect to (or create) an SQLite database</span></span>
<span><span class="co"># stored in a file on the local system:</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">nodbi</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/nodbi/reference/src_sqlite.html" class="external-link">src_sqlite</a></span><span class="op">(</span></span>
<span>  dbname <span class="op">=</span> <span class="st">"some_database_name.sqlite_file"</span>,</span>
<span>  collection <span class="op">=</span> <span class="st">"some_collection_name"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, the trial information is retrieved and loaded into the collection:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve trials from public register:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="va">q</span>,</span>
<span>  euctrresults <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Checking trials in EUCTR...</span></span>
<span><span class="co"># Retrieved overview, multiple records of 73 trial(s) from 4 page(s) to be downloaded (estimate: 9 MB)</span></span>
<span><span class="co"># (1/3) Downloading trials...</span></span>
<span><span class="co"># Note: register server cannot compress data, transfer takes longer (estimate: 90 s)</span></span>
<span><span class="co"># Download status: 4 done; 0 in progress. Total size: 6.39 Mb (100%)... done!             </span></span>
<span><span class="co"># (2/3) Converting to NDJSON (estimate: 1 s)...</span></span>
<span><span class="co"># (3/3) Importing records into database...</span></span>
<span><span class="co"># = Imported or updated 270 records on 73 trial(s) </span></span>
<span><span class="co"># * Checking results if available from EUCTR for 73 trials: </span></span>
<span><span class="co"># (1/4) Downloading results...</span></span>
<span><span class="co"># Download status: 73 done; 0 in progress. Total size: 22.57 Mb (100%)... done!             </span></span>
<span><span class="co"># Download status: 41 done; 0 in progress. Total size: 165.04 Kb (100%)... done!             </span></span>
<span><span class="co"># Download status: 41 done; 0 in progress. Total size: 165.04 Kb (100%)... done!             </span></span>
<span><span class="co"># - extracting results (. = data, F = file[s] and data, x = none):</span></span>
<span><span class="co"># F F . . . . . . . F . . . F . . . F . . . . . F . . . . . . . F </span></span>
<span><span class="co"># (2/4) Converting to NDJSON (estimate: 3 s)...</span></span>
<span><span class="co"># (3/4) Importing results into database (may take some time)...</span></span>
<span><span class="co"># (4/4) Results history: not retrieved (euctrresultshistory = FALSE)</span></span>
<span><span class="co"># = Imported or updated results for 32 trials</span></span>
<span><span class="co"># No history found in expected format.</span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 270</span></span></code></pre></div>
<p>Under the hood, EUCTR plain text and XML files from EUCTR, CTGOV, ISRCTN are converted using Javascript via <code>V8</code> in <code>R</code> into <code>NDJSON</code>, which is imported into the database collection.</p>
<ul>
<li>Easily generate queries for each register and add records from several registers into the same collection</li>
</ul>
<p>The same parameters can be used to ask <code>ctrdata</code> to generate search queries that apply to each register, for opening the web interfaces and for loading the trial data into the collection:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate queries for each register</span></span>
<span><span class="va">queries</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ctrGenerateQueries.html">ctrGenerateQueries</a></span><span class="op">(</span></span>
<span>  condition <span class="op">=</span> <span class="st">"neuroblastoma"</span>,</span>
<span>  recruitment <span class="op">=</span> <span class="st">"completed"</span>,</span>
<span>  phase <span class="op">=</span> <span class="st">"phase 2"</span>,</span>
<span>  population <span class="op">=</span> <span class="st">"P"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">queries</span></span>
<span><span class="co"># EUCTR </span></span>
<span><span class="co"># "https://www.clinicaltrialsregister.eu/ctr-search/search?query=neuroblastoma&amp;phase=phase-two</span></span>
<span><span class="co"># &amp;age=children&amp;age=adolescent&amp;age=infant-and-toddler&amp;age=newborn&amp;age=preterm-new-born-infants</span></span>
<span><span class="co"># &amp;age=under-18&amp;status=completed" </span></span>
<span><span class="co"># CTGOV2 </span></span>
<span><span class="co"># "https://clinicaltrials.gov/search?cond=neuroblastoma&amp;aggFilters=phase:2,ages:child,status:com" </span></span>
<span><span class="co"># ISRCTN </span></span>
<span><span class="co"># "https://www.isrctn.com/search?&amp;filters=condition:neuroblastoma,phase:Phase II,ageRange:Child,trialStatus:completed&amp;q=" </span></span>
<span><span class="co"># CTIS </span></span>
<span><span class="co"># "https://euclinicaltrials.eu/ctis-public/search#searchCriteria={\"medicalCondition\":</span></span>
<span><span class="co"># \"neuroblastoma\",\"trialPhaseCode\":[4],\"ageGroupCode\":[2],\"status\":[5,8]}" </span></span>
<span></span>
<span><span class="co"># Open queries in registers' web interfaces</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">queries</span>, <span class="va">ctrOpenSearchPagesInBrowser</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load all queries into database collection</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">queries</span>, <span class="va">ctrLoadQueryIntoDb</span>, con <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"[["</span>, <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co"># EUCTR CTGOV2 ISRCTN   CTIS </span></span>
<span><span class="co">#   180    111      0      1 </span></span></code></pre></div>
<ul>
<li>Analyse</li>
</ul>
<p>Tabulate the status of trials that are part of an agreed paediatric development program (paediatric investigation plan, PIP). <code>ctrdata</code> functions return a data.frame (or a tibble, if package <code>tibble</code> is loaded).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all records that have values in the fields of interest:</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  <span class="co"># Field of interest </span></span>
<span>  fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a7_trial_is_part_of_a_paediatric_investigation_plan"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Trial concepts calculated across registers</span></span>
<span>  calculate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f.statusRecruitment"</span>, <span class="st">"f.isUniqueTrial"</span><span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Querying database (35 fields)...</span></span>
<span><span class="co"># - Finding duplicates among registers' and sponsor ids...     </span></span>
<span><span class="co"># - 114 EUCTR _id were not preferred EU Member State record for 40 trials</span></span>
<span><span class="co"># - Keeping 111 / 34 / 0 / 0 / 1 records from CTGOV2 / EUCTR / CTGOV / ISRCTN / CTIS</span></span>
<span></span>
<span><span class="co"># Tabulate the clinical trial information of interest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">result</span><span class="op">[</span><span class="va">result</span><span class="op">$</span><span class="va">.isUniqueTrial</span>, <span class="op">]</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span></span>
<span>    <span class="va">.statusRecruitment</span>,</span>
<span>    <span class="va">a7_trial_is_part_of_a_paediatric_investigation_plan</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#                   a7_trial_is_part_of_a_paediatric_investigation_plan</span></span>
<span><span class="co"># .statusRecruitment FALSE TRUE</span></span>
<span><span class="co">#        ongoing         3    2</span></span>
<span><span class="co">#        completed      13    5</span></span>
<span><span class="co">#        ended early     5    4</span></span>
<span><span class="co">#        other           9    4</span></span></code></pre></div>
<div id="workflow-ctgov-example">

</div>
<ul>
<li>Queries to CTGOV and CTGOV2</li>
</ul>
<p>The new website and API introduced in July 2023 (<a href="https://www.clinicaltrials.gov/" class="external-link uri">https://www.clinicaltrials.gov/</a>) is supported by <code>ctrdata</code> since mid-2023 and identified in <code>ctrdata</code> as <code>CTGOV2</code>.</p>
<p>On 2024-06-25, <code>CTGOV</code> has retired the classic website and API used by <code>ctrdata</code> since 2015. To support users, <code>ctrdata</code> automatically translates and redirects queries to the current website. This helps with automatically updating previously loaded queries (<code>ctrLoadQueryIntoDb(querytoupdate = &lt;n&gt;)</code>), manually migrating queries and reproducible work on clinical trials information. Going forward, users are recommended to change to use <code>CTGOV2</code> queries.</p>
<p>As regards study data, important differences exist between field names and contents of information retrieved using <code>CTGOV</code> or <code>CTGOV2</code>; see the <a href="https://cdn.clinicaltrials.gov/documents/xsd/prs/ProtocolRecordSchema.xsd" class="external-link">schema for study protocols in <code>CTGOV</code></a>, the <a href="https://cdn.clinicaltrials.gov/documents/xsd/prs/RRSUploadSchema.xsd" class="external-link">schema for study results</a> and the <a href="https://clinicaltrials.gov/data-api/about-api/study-data-structure" class="external-link">Study Data Structure for <code>CTGOV2</code></a>. For more details, call <code><a href="reference/ctrdata-registers.html">help("ctrdata-registers")</a></code>. This is one of the reasons why <code>ctrdata</code> handles the situation as if these were two different registers and will continue to identify the current API as <code>register = "CTGOV2"</code>, to support the analysis stage.</p>
<p>Note that loading trials with <code>ctrdata</code> overwrites the previous record with <code>CTGOV2</code> data, whether the previous record was retrieved using <code>CTGOV</code> or <code>CTGOV2</code> queries.</p>
<p>Example using a CTGOV query:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CTGOV search query URL</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="st">"https://classic.clinicaltrials.gov/ct2/results?cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug"</span></span>
<span></span>
<span><span class="co"># Open old URL (CTGOV) in current website (CTGOV2):</span></span>
<span><span class="fu"><a href="reference/ctrOpenSearchPagesInBrowser.html">ctrOpenSearchPagesInBrowser</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span></span>
<span><span class="co"># * Appears specific for CTGOV Classic website</span></span>
<span><span class="co"># Since 2024-06-25, the classic CTGOV servers are no longer available. </span></span>
<span><span class="co"># Package ctrdata has translated the classic CTGOV query URL from this call </span></span>
<span><span class="co"># of function ctrLoadQueryIntoDb(queryterm = ...) into a query URL that works </span></span>
<span><span class="co"># with the current CTGOV2. This is printed below and is also part of the return </span></span>
<span><span class="co"># value of this function, ctrLoadQueryIntoDb(...)$url. This URL can be used with </span></span>
<span><span class="co"># ctrdata functions. Note that the fields and data schema of trials differ </span></span>
<span><span class="co"># between CTGOV and CTGOV2. </span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Replace this URL:</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># https://classic.clinicaltrials.gov/ct2/results?cond=neuroblastoma&amp;rslt=With&amp;recrs=e&amp;age=0&amp;intr=Drug</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># with this URL:</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># https://clinicaltrials.gov/search?cond=neuroblastoma&amp;intr=Drug&amp;aggFilters=ages:child,results:with,status:com</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># * Found search query from CTGOV2: cond=neuroblastoma&amp;intr=Drug&amp;aggFilters=ages:child,results:with,status:com</span></span>
<span></span>
<span><span class="co"># Count trials:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="va">q</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span>, </span>
<span>  only.count <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 70</span></span></code></pre></div>
<div id="workflow-ctis-example">

</div>
<ul>
<li>Queries to CTIS</li>
</ul>
<p>Queries in the CTIS search interface can be automatically copied to the clipboard so that a user can paste them into <code>queryterm</code>, see <a href="#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>. Subsequent to the relaunch of CTIS on 2024-07-18, there are more than 8,700 trials publicly accessible in CTIS. See <a href="#documents-example">below</a> for how to download documents from CTIS.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See how many trials are in CTIS publicly accessible:</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">""</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"CTIS"</span>,</span>
<span>  only.count <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># $n</span></span>
<span><span class="co"># [1] 8783</span></span></code></pre></div>
<div id="workflow-data-model">

</div>
<ul>
<li>Inspect and search structure of trial information</li>
</ul>
<p>For a given trial, function <a href="https://rfhb.github.io/ctrdata/reference/ctrShowOneTrial.html">ctrShowOneTrial()</a> enables the user to visualise the hiearchy of fields and contents in the user‚Äôs local web browser, to search for field names and field values, and to select and copy selected fields‚Äô names for use with function <a href="https://rfhb.github.io/ctrdata/reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf()</a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This opens a local browser for user interaction. </span></span>
<span><span class="co"># If the trial identifier (_id) is not found in the</span></span>
<span><span class="co"># specified collection, it will be retrieved from the register. </span></span>
<span><span class="fu"><a href="reference/ctrShowOneTrial.html">ctrShowOneTrial</a></span><span class="op">(</span></span>
<span>  identifier <span class="op">=</span> <span class="st">"2024-518931-12-00"</span>, </span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="workflow-cross-trial-example">

</div>
<ul>
<li>Analysis across trials</li>
</ul>
<p>Show cumulative start of trials over time. This uses the calculation of trial concepts as available since <code>ctrdata</code> version 1.21.0 üîî.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use helper package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  fields <span class="op">=</span> <span class="st">""</span>,</span>
<span>  calculate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f.statusRecruitment"</span>, <span class="st">"f.isUniqueTrial"</span>, <span class="st">"f.startDate"</span><span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.isUniqueTrial</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.startDate</span>,</span>
<span>    colour <span class="op">=</span> <span class="va">.statusRecruitment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Evolution over time of selected trials"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Data from EUCTR, CTIS, ISRCTN, CTGOV2"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date of start (proposed or realised)"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Cumulative proportion of trials"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"Current status"</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"man/figures/README-ctrdata_across_registers.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"in"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_across_registers.png" alt="Analysis across registers"><figcaption aria-hidden="true">
Analysis across registers
</figcaption></figure><ul>
<li>Result-related trial information</li>
</ul>
<p>Analyse some simple result details, here from CTGOV2 (see this <a href="https://rfhb.github.io/ctrdata/articles/ctrdata_summarise.html">vignette</a> for more examples):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use helper package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dbGetFieldsIntoDf.html">dbGetFieldsIntoDf</a></span><span class="op">(</span></span>
<span>  calculate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"f.numSites"</span>, </span>
<span>    <span class="st">"f.sampleSize"</span>, </span>
<span>    <span class="st">"f.controlType"</span>, </span>
<span>    <span class="st">"f.numTestArmsSubstances"</span><span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">result</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Selected trials"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Patients with a neuroblastoma"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.numSites</span>,</span>
<span>      y <span class="op">=</span> <span class="va">.sampleSize</span>,</span>
<span>      size <span class="op">=</span> <span class="va">.numTestArmsSubstances</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">.controlType</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Number of sites"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total number of participants"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"Control"</span>, </span>
<span>    size <span class="op">=</span> <span class="st">"# Treatments"</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="st">"man/figures/README-ctrdata_results_neuroblastoma.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">3</span>, units <span class="op">=</span> <span class="st">"in"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_results_neuroblastoma.png" alt="Neuroblastoma trials"><figcaption aria-hidden="true">
Neuroblastoma trials
</figcaption></figure><div id="documents-example">

</div>
<ul>
<li>Download documents: retrieve protocols, statistical analysis plans and other documents into the local folder <code>./files-.../</code>
</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### EUCTR document files can be downloaded when results are requested</span></span>
<span><span class="co"># All files are downloaded and saved (documents.regexp is not used with EUCTR) </span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"query=cancer&amp;age=under-18&amp;phase=phase-one"</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"EUCTR"</span>,</span>
<span>  euctrresults <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-euctr/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from EUCTR: query=cancer&amp;age=under-18&amp;phase=phase-one</span></span>
<span><span class="co"># * Checking trials in EUCTR...</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># = documents saved in './files-euctr'</span></span>
<span><span class="co"># Updated history ("meta-info" in "some_collection_name")</span></span>
<span></span>
<span></span>
<span><span class="co">### CTGOV files are downloaded, here corresponding to the default of </span></span>
<span><span class="co"># documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|ctalett|lay|^[0-9]+ "</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"cond=Neuroblastoma&amp;type=Intr&amp;recrs=e&amp;phase=1&amp;u_prot=Y&amp;u_sap=Y&amp;u_icf=Y"</span>,</span>
<span>  register <span class="op">=</span> <span class="st">"CTGOV"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctgov/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Checking for documents...</span></span>
<span><span class="co"># - Getting links to documents</span></span>
<span><span class="co"># - Downloading documents into 'documents.path' = ./files-ctgov/</span></span>
<span><span class="co"># - Created directory ./files-ctgov</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 40 missing documents</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Downloading 40 missing documents </span></span>
<span><span class="co"># Download status: 40 done; 0 in progress. Total size: 110.75 Mb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 40 document(s) for 32 trial(s); 0 of such document(s) for 0 trial(s) </span></span>
<span><span class="co"># already existed in ./files-ctgov</span></span>
<span></span>
<span></span>
<span><span class="co">### CTGOV2 files are downloaded, using the default of documents.regexp</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://clinicaltrials.gov/search?cond=neuroblastoma&amp;aggFilters=phase:1,results:with"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctgov2/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Checking for documents...</span></span>
<span><span class="co"># - Getting links to documents</span></span>
<span><span class="co"># - Downloading documents into 'documents.path' = ./files-ctgov2/</span></span>
<span><span class="co"># - Created directory ./files-ctgov2</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 42 missing documents</span></span>
<span><span class="co"># - Downloading 42 missing documents</span></span>
<span><span class="co"># Download status: 42 done; 0 in progress. Total size: 92.57 Mb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 42 document(s) for 26 trial(s); 0 of such document(s) for 0 </span></span>
<span><span class="co"># trial(s) already existed in ./files-ctgov2</span></span>
<span></span>
<span></span>
<span><span class="co">### ISRCTN files are downloaded, using the default of documents.regexp</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="st">"https://www.isrctn.com/search?q=alzheimer"</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-isrctn/"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from ISRCTN: q=alzheimer</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># * Checking for documents...                      </span></span>
<span><span class="co"># - Getting links to documents</span></span>
<span><span class="co"># - Downloading documents into 'documents.path' = ./files-isrctn/</span></span>
<span><span class="co"># - Created directory /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-isrctn</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 52 missing documents</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Downloading 32 missing documents </span></span>
<span><span class="co"># Download status: 32 done; 0 in progress. Total size: 14.89 Mb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 26 document(s) for 15 trial(s); 0 of such document(s) for 0 </span></span>
<span><span class="co"># trial(s) already existed in ./files-isrctn</span></span>
<span></span>
<span></span>
<span><span class="co">### CTIS files are downloaded, using the default of documents.regexp</span></span>
<span><span class="fu"><a href="reference/ctrLoadQueryIntoDb.html">ctrLoadQueryIntoDb</a></span><span class="op">(</span></span>
<span>  queryterm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">'https://euclinicaltrials.eu/ctis-public/search#'</span>, </span>
<span>    <span class="st">'searchCriteria={"containAny":"cancer","status":[8]}'</span><span class="op">)</span>,</span>
<span>  documents.path <span class="op">=</span> <span class="st">"./files-ctis/"</span>,</span>
<span>  documents.regexp <span class="op">=</span> <span class="st">"icf"</span>,</span>
<span>  con <span class="op">=</span> <span class="va">db</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># * Found search query from CTIS: searchCriteria={"containAny":"cancer"}</span></span>
<span><span class="co"># [...]</span></span>
<span><span class="co"># * Checking for documents: . . . . . . . . . . . . . . . . . . . </span></span>
<span><span class="co"># - Downloading documents into 'documents.path' = ./files-ctis/</span></span>
<span><span class="co"># - Applying 'documents.regexp' to 1114 missing documents</span></span>
<span><span class="co"># - Creating subfolder for each trial</span></span>
<span><span class="co"># - Downloading 512 missing documents (excluding 2 files with duplicate names </span></span>
<span><span class="co"># for saving, e.g. /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-ctis/2022-</span></span>
<span><span class="co"># 500694-14-00/SbjctInfaICF - L1 SIS and ICF Prescreening ICF clean placeholder</span></span>
<span><span class="co"># - 137297.PDF, /Users/ralfherold/Daten/mak/r/emea/ctrdata/files-ctis/2022-</span></span>
<span><span class="co"># 500694-14-00/SbjctInfaICF - L1 SIS and ICF Pregnant Partner ICF clean - </span></span>
<span><span class="co"># 137297.PDF) </span></span>
<span><span class="co"># Download status: 510 done; 0 in progress. Total size: 377.27 Kb (100%)... done!             </span></span>
<span><span class="co"># Redirecting to CDN...</span></span>
<span><span class="co"># Download status: 127 done; 0 in progress. Total size: 47.66 Mb (100%)... done!             </span></span>
<span><span class="co"># = Newly saved 510 document(s) for 35 trial(s); 0 of such document(s) for 0 </span></span>
<span><span class="co"># trial(s) already existed in ./files-ctis</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tests">Tests<a class="anchor" aria-label="anchor" href="#tests"></a>
</h2>
<p>See also <a href="https://app.codecov.io/gh/rfhb/ctrdata/tree/master/R" class="external-link uri">https://app.codecov.io/gh/rfhb/ctrdata/tree/master/R</a></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tinytest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytest/man/run_test_dir.html" class="external-link">test_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># test_ctrdata_ctrfindactivesubstance.R    4 tests OK 0.8s</span></span>
<span><span class="co"># test_ctrdata_duckdb_ctgov2.R..   78 tests OK 47.3s</span></span>
<span><span class="co"># test_ctrdata_function_ctrgeneratequeries.R   12 tests OK 4ms</span></span>
<span><span class="co"># test_ctrdata_function_dfcalculate.R   26 tests OK 2.0s</span></span>
<span><span class="co"># test_ctrdata_other_functions.R   67 tests OK 3.1s</span></span>
<span><span class="co"># test_ctrdata_postgres_ctgov2.R   50 tests OK 32.0s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctgov.R...  108 tests OK 30.8s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctgov2.R..   50 tests OK 26.8s</span></span>
<span><span class="co"># test_ctrdata_sqlite_ctis.R....   63 tests OK 49.4s</span></span>
<span><span class="co"># test_ctrdata_sqlite_euctr.R...  115 tests OK 44.2s</span></span>
<span><span class="co"># test_ctrdata_sqlite_isrctn.R..   38 tests OK 12.5s</span></span>
<span><span class="co"># test_euctr_error_sample.R.....    8 tests OK 0.2s</span></span>
<span><span class="co"># All ok, 619 results (4m 9.2s)</span></span>
<span></span>
<span><span class="fu">covr</span><span class="fu">::</span><span class="fu"><a href="http://covr.r-lib.org/reference/package_coverage.html" class="external-link">package_coverage</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"."</span>, type <span class="op">=</span> <span class="st">"tests"</span><span class="op">)</span></span>
<span><span class="co"># ctrdata Coverage: 94.06%</span></span>
<span><span class="co"># R/ctrShowOneTrial.R: 57.89%</span></span>
<span><span class="co"># R/ctrRerunQuery.R: 74.85%</span></span>
<span><span class="co"># R/zzz.R: 80.95%</span></span>
<span><span class="co"># R/dbGetFieldsIntoDf.R: 86.90%</span></span>
<span><span class="co"># R/util_functions.R: 89.52%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbEuctr.R: 90.08%</span></span>
<span><span class="co"># R/ctrGetQueryUrl.R: 90.09%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbIsrctn.R: 92.45%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbCtgov2.R: 92.90%</span></span>
<span><span class="co"># R/ctrFindActiveSubstanceSynonyms.R: 93.62%</span></span>
<span><span class="co"># R/dfMergeVariablesRelevel.R: 94.29%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDb.R: 94.81%</span></span>
<span><span class="co"># R/ctrLoadQueryIntoDbCtis.R: 95.26%</span></span>
<span><span class="co"># R/dbFindFields.R: 95.88%</span></span>
<span><span class="co"># R/vct_primaryEndpointResults.R: 96.27%</span></span>
<span><span class="co"># R/ctrOpenSearchPagesInBrowser.R: 97.37%</span></span>
<span><span class="co"># R/dbFindIdsUniqueTrials.R: 97.87%</span></span>
<span><span class="co"># R/vct_numTestArmsSubstances.R: 97.95%</span></span>
<span><span class="co"># R/ctrGenerateQueries.R: 100.00%</span></span>
<span><span class="co"># R/dbQueryHistory.R: 100.00%</span></span>
<span><span class="co"># R/dfName2Value.R: 100.00%</span></span>
<span><span class="co"># R/dfTrials2Long.R: 100.00%</span></span>
<span><span class="co"># R/vct_controlType.R: 100.00%</span></span>
<span><span class="co"># R/vct_isMedIntervTrial.R: 100.00%</span></span>
<span><span class="co"># R/vct_isPlatformTrial.R: 100.00%</span></span>
<span><span class="co"># R/vct_isUniqueTrial.R: 100.00%</span></span>
<span><span class="co"># R/vct_numSites.R: 100.00%</span></span>
<span><span class="co"># R/vct_primaryEndpointDescription.R: 100.00%</span></span>
<span><span class="co"># R/vct_resultsDate.R: 100.00%</span></span>
<span><span class="co"># R/vct_sampleSize.R: 100.00%</span></span>
<span><span class="co"># R/vct_sponsorType.R: 100.00%</span></span>
<span><span class="co"># R/vct_startDate.R: 100.00%</span></span>
<span><span class="co"># R/vct_statusRecruitment.R: 100.00%</span></span>
<span><span class="co"># R/vct_trialObjectives.R: 100.00%</span></span>
<span><span class="co"># R/vct_trialPhase.R: 100.00%</span></span>
<span><span class="co"># R/vct_trialPopulation.R: 100.00%</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="future-features">Future features<a class="anchor" aria-label="anchor" href="#future-features"></a>
</h2>
<ul>
<li><p>See project outline <a href="https://github.com/users/rfhb/projects/1" class="external-link uri">https://github.com/users/rfhb/projects/1</a></p></li>
<li><p>Authentication, expected to be required by CTGOV2; specifications not yet known (work not yet started).</p></li>
<li><p>Explore further registers (exploration is continually ongoing; added value, terms and conditions for programmatic access vary; no clear roadmap is established yet).</p></li>
</ul>
<p>Implemented:</p>
<ul>
<li><p><del>Retrieve previous versions of protocol- or results-related information. The challenges include, historic versions can only be retrieved one-by-one, do not include results, or are not in structured format. The functionality available with version 1.17.3 to the extent that is possible at this time, namely for protocol- and results-related information in CTGOV2, only</del></p></li>
<li><p><del>Canonical definitions, filters, calculations are in the works (since August 2023) for data mangling and analyses across registers, e.g.¬†to define study population, identify interventional trials, calculate study duration; public collaboration on these canonical scripts will speed up harmonising analyses.</del></p></li>
<li><p><del>Merge results-related fields retrieved from different registers, such as corresponding endpoints (work not yet started). The challenge is the incomplete congruency and different structure of data fields.</del></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<ul>
<li><p>Data providers and curators of the clinical trial registers. Please review and respect their copyrights and terms and conditions, see <code>ctrOpenSearchPagesInBrowser(copyright = TRUE)</code>.</p></li>
<li><p>Package <code>ctrdata</code> has been made possible building on the work done for <a href="https://www.r-project.org/" class="external-link">R</a>, <a href="https://cran.r-project.org/package=clipr" class="external-link">clipr</a>. <a href="https://cran.r-project.org/package=curl" class="external-link">curl</a>, <a href="https://cran.r-project.org/package=dplyr" class="external-link">dplyr</a>, <a href="https://cran.r-project.org/package=duckdb" class="external-link">duckdb</a>, <a href="https://cran.r-project.org/package=httr" class="external-link">httr</a>, <a href="https://cran.r-project.org/package=jqr" class="external-link">jqr</a>, <a href="https://cran.r-project.org/package=jsonlite" class="external-link">jsonlite</a>, <a href="https://cran.r-project.org/package=lubridate" class="external-link">lubridate</a>, <a href="https://cran.r-project.org/package=mongolite" class="external-link">mongolite</a>, <a href="https://cran.r-project.org/package=nodbi" class="external-link">nodbi</a>, <a href="https://cran.r-project.org/package=RPostgres" class="external-link">RPostgres</a>, <a href="https://CRAN.R-project.org/package=RSQLite" class="external-link">RSQLite</a>, <a href="https://cran.r-project.org/package=rvest" class="external-link">rvest</a>, <a href="https://cran.r-project.org/package=stringi" class="external-link">stringi</a> and <a href="https://cran.r-project.org/package=xml2" class="external-link">xml2</a>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="issues-and-notes">Issues and notes<a class="anchor" aria-label="anchor" href="#issues-and-notes"></a>
</h2>
<ul>
<li><p>Information in trial registers may not be fully correct; see for example <a href="https://doi.org/10.1136/bmj.k1452" class="external-link">this publication on CTGOV</a>.</p></li>
<li><p>A warning may be issued and a record not imported if the complexity of the XML content is too high for processing. The issue can be resolved by increasing in the operating system the stack size available to R, see: <a href="https://github.com/rfhb/ctrdata/issues/22" class="external-link uri">https://github.com/rfhb/ctrdata/issues/22</a></p></li>
<li><p>Please file issues and bugs <a href="https://github.com/rfhb/ctrdata/issues" class="external-link">here</a>. Also check out how to handle some of the closed issues, e.g.¬†on <a href="https://github.com/rfhb/ctrdata/issues/22" class="external-link">C stack usage too close to the limit</a> and on a <a href="https://github.com/rfhb/ctrdata/issues/19#issuecomment-820127139" class="external-link">SSL certificate problem: unable to get local issuer certificate</a>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="trial-records-in-databases">Trial records in databases<a class="anchor" aria-label="anchor" href="#trial-records-in-databases"></a>
</h2>
<div class="section level3">
<h3 id="sqlite">SQLite<a class="anchor" aria-label="anchor" href="#sqlite"></a>
</h3>
<p>It is recommended to use nodbi &gt;= 0.10.7.9000 which builds on RSQLite &gt;= 2.3.7.9014 (releases expected in November 2024), because these versions enable file-based imports and thus are much faster:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install latest development versions:</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/nodbi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># requires compilation, for which under MS Windows</span></span>
<span><span class="co"># automatically additional R Tools are installed:</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"r-dbi/RSQLite"</span><span class="op">)</span></span></code></pre></div>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_json_sqlite.jpg" alt="Example JSON representation in SQLite"><figcaption aria-hidden="true">
Example JSON representation in SQLite
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="mongodb">MongoDB<a class="anchor" aria-label="anchor" href="#mongodb"></a>
</h3>
<figure><img src="https://raw.githubusercontent.com/rfhb/ctrdata/master/docs/reference/figures/README-ctrdata_json_mongodb.jpg" alt="Example JSON representation in MongoDB"><figcaption aria-hidden="true">
Example JSON representation in MongoDB
</figcaption></figure>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ralf Herold <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8148-6748" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="table-of-contents">
<h2 data-toc-skip>Table of contents</h2>
<ul class="list-unstyled">
<li><nav id="toc"></nav></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ralf Herold.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
